{"version":3,"sources":["components/Stem/index.jsx","components/util/PlusButton/PlusButton.jsx","components/Effect/index.jsx","components/Track/index.jsx","components/LaunchSpace/index.jsx","actions/index.js","Connection.js","reducers/State.js","actions/GlobalActions.js","containers/LaunchSpace.jsx","components/CodeEditor/index.jsx","components/MasterEditor/index.jsx","components/StemEditor/index.jsx","components/Flyout/index.jsx","containers/Flyout.jsx","components/Render/index.jsx","containers/Render.jsx","components/App/index.jsx","containers/App.jsx","containers/AudienceRender.jsx","index.js","reducers/index.js","Renderers/Hydra/Hydra.js","Renderers/TidalCycles/index.jsx","Renderers/index.js","components/AudienceRender/index.jsx"],"names":["Stem","props","state","id","name","on","code","language","effects","holdTime","Date","className","this","selected","tabIndex","onKeyUp","bind","onMouseUp","mouseDown","onContextMenu","x","preventDefault","openInFlyout","style","width","e","ctrlKey","key","globalActions","pasteStems","trackId","toggle","shiftKey","updateStem","button","open","Component","PlusButton","Effect","sliderValue","toSliderScale","value","updateState","throttle","_handleSliderChange","handleInputChange","_handleInputChange","scale","range","max","min","Math","pow","round","step","isVertical","renderVertical","renderHorizontal","newValue","newEffect","Object","assign","fromSliderScale","updateEffect","parseFloat","target","checked","noToggle","Switch","color","onChange","Grid","container","spacing","alignItems","item","xs","Slider","setState","Input","margin","persist","inputProps","type","orientation","textAlign","Track","nextProps","nextState","JSON","stringify","stems","map","titleChange","onClick","addStem","xmlns","fill","height","viewBox","d","newEffects","updateTrack","LaunchSpace","tracks","trackToDom","newTrack","display","top","minWidth","toLowerCase","flat","filter","forEach","removeStem","copyStems","addTrack","Actions","url","port","isConnected","tempo","bootScript","opt_stems","store","getState","stemId","live","newState","keys","Types","Connection","host","window","location","hostname","onOpen","onClose","onErr","ws","close","WebSocket","MozWebSocket","isOpen","onopen","console","log","onerror","warn","onclose","data","send","languages","State","uniqueId","operator","getDefaultStem","cloneStem","stem","getDefaultEffects","defaultState","copy","getDefaultTrack","masterEffects","connection","getDefaultEffect","GlobalActions","dispatch","connect","CONNECT","onError","init","updateTempo","UPDATE_TEMPO","updateBootScript","UPDATE_BOOT_SCRIPT","COPY_STEMS","PASTE_STEMS","track","UPDATE_STEM","ADD_TRACK","removeTrack","REMOVE_TRACK","ADD_STEM","REMOVE_STEM","OPEN_IN_FLYOUT","UPDATE_TRACK","updateMasterEffect","UPDATE_MASTER_EFFECT","toggleLive","TOGGLE_LIVE","save","localStorage","setItem","load","getItem","reassignIDs","obj","i","parse","LOAD","download","dataStr","encodeURIComponent","anchor","document","createElement","setAttribute","click","DOWNLOAD","openFile","file","text","then","input","onchange","files","CodeEditor","updateCode","debounce","flashTimeout","onChangeLive","Button","disabled","variant","flash","onKeyPress","clearTimeout","setTimeout","MasterEditor","bootScriptLive","length","effect","push","marginTop","random","changeTempo","border","TextField","marginLeft","label","maxWidth","parseInt","trailing","StemEditor","_updateCode","textAreaRef","React","createRef","backgroundColor","updateName","handleLanguageChange","delete","current","classList","add","remove","Tab","switchToTab","closeAble","closeTab","Flyout","tab","history","opened","_getOpenedStems","includes","concat","slice","openStems","switchTab","tabs","keyVal","content","Render","iframeRef","tidalCode","hydraCode","poppedOut","tidal","Renderers","TidalCycles","getCode","sendCode","getTempoCode","contentWindow","msg","postMessage","iframe","popoutRender","title","ref","src","App","divider","horizontalDivider","appRef","onDragOver","onKeyDown","macros","px","body","clientWidth","clientHeight","AudienceRender","addEventListener","origin","createStore","oldTrack","action","find","getStemPosition","trackIndex","findIndex","stemIndex","pasteStemAtPosition","pos","newStem","anchorStem","anchorPos","insertPos","position","relativePos","newPos","index","newTracks","SAVE","applyMiddleware","logger","render","path","exact","component","getElementById","Hydra","fullState","mixMethod","tracksCode","stemsCode","stemToCode","trackToCode","getAudienceDom","join","onMasterEffects","effectToCode","effectToDom","stemToDom","effectsOn","effectsCode","hydraRef","hydra","canvas","hydraDom","tidalDom","eval"],"mappings":"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","file":"static/js/main.0ac3151d.chunk.js","sourcesContent":["import React, {Component} from 'react'\r\nimport './index.css'\r\n\r\nexport default class Stem extends Component{\r\n    constructor (props){\r\n        super(props);\r\n        this.state = {\r\n            id:props.id,\r\n            name:props.name,\r\n            on: props.on,\r\n            code: props.code,\r\n            language: props.language,\r\n            effects: props.effects,\r\n            holdTime: new Date()\r\n        }\r\n    }\r\n\r\n    render(){\r\n        return (\r\n            <div\r\n                className={'Stem noselect'+(this.props.on?' on ':' off ')+ (this.props.selected?'selected':'')}\r\n                // onMouseUp={this.mouseUp.bind(this)}\r\n                tabIndex={0}\r\n                onKeyUp={this.onKeyUp.bind(this)}\r\n                onMouseUp={this.mouseDown.bind(this)}\r\n                onContextMenu={(x)=>{x.preventDefault();this.openInFlyout()}}\r\n                // onTouchMove={this.onTouchStart.bind(this)}\r\n                // onTouchStart={this.toggle.bind(this)}\r\n                // onTouchEnd={this.mouseUp.bind(this)}\r\n            >\r\n                <div className=\"verticalCenter\" style={{width:'100%'}}>\r\n                    {this.props.name}\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    onKeyUp(e){\r\n        if(e.ctrlKey && e.key==='v'){\r\n            this.props.globalActions.pasteStems(this.props.trackId,this.props.id);\r\n        }\r\n\r\n    }\r\n\r\n    mouseUp(){\r\n        if((new Date())-this.state.holdTime > 1000){\r\n            this.openInFlyout();\r\n        } else{\r\n            this.toggle();\r\n        }\r\n    }\r\n\r\n    onTouchStart(){\r\n        this.toggle();\r\n    }\r\n\r\n    mouseDown(e){\r\n        if(e.shiftKey){\r\n            this.props.globalActions.updateStem(this.props.trackId, this.props.id,{selected:!this.props.selected});\r\n        } else {\r\n            if(e.button){\r\n                e.preventDefault();\r\n            } else{\r\n                this.toggle()\r\n            }\r\n        }\r\n    }\r\n\r\n    openInFlyout(){\r\n        this.props.globalActions.updateStem(this.props.trackId,this.state.id, {open:true});\r\n    }\r\n\r\n    toggle(){\r\n        this.props.globalActions.updateStem(this.props.trackId, this.props.id, {on:!this.props.on} )\r\n    }\r\n}","import React , {Component} from \"react\";\r\nimport './index.css'\r\n\r\nexport default class PlusButton extends Component {\r\n\r\n    render() {\r\n        return (\r\n            <div {...this.props} className={\"plusButton\"}>\r\n                <div>+</div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n}","import React, {Component} from 'react';\r\nimport './index.css'\r\nimport {Grid, Slider, Switch,Input} from '@material-ui/core';\r\nimport throttle from 'lodash/throttle'\r\n\r\n// import Slider from 'rc-slider'\r\n// import 'rc-slider/assets/index.css';\r\n// export class Filter extends React.Component {\r\n//     constructor(props) {\r\n//         super(props)\r\n//         const { value } = this.props\r\n//         this.state = { value }\r\n//     }\r\n//     setValue(e) {\r\n//         // this.props.update({value:e});\r\n//         this.setState({ value: e })\r\n//     }\r\n//     update() {\r\n//         this.props.update(this.state)\r\n//     }\r\n//     render() {\r\n//         return <Slider value={this.state.value} onChange={this.setValue.bind(this)} onAfterChange={this.update.bind(this)} min={this.props.min} max={this.props.max} step={this.props.step}/>\r\n//     }\r\n// }\r\n\r\n// class Slider extends Component {\r\n//\r\n//     constructor(props) {\r\n//         super(props)\r\n//         this.img = new Image();\r\n//         this.img.src = 'data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=';\r\n//         this.oldVal = this.props.value;\r\n//         this.state={\r\n//             value:this.props.value\r\n//         }\r\n//     }\r\n//\r\n//     send(e){\r\n//         let rect = e.target.getBoundingClientRect();\r\n//         if(e.dataTransfer){\r\n//             e.dataTransfer.setDragImage(this.img, 0, 0);\r\n//         }\r\n//         let value = Math.round(Math.max(Math.min(this.props.max, (e.clientX-rect.left)/rect.width),this.props.min)/this.props.step)*this.props.step;\r\n//         // console.log(e.target.getBoundingClientRect().width);\r\n//         if(value !== this.oldVal){\r\n//             console.log(value);\r\n//             this.props.onChange(value);\r\n//         }\r\n//     }\r\n//\r\n//     render() {\r\n//         let pos = this.state.value/(this.props.max-this.props.min);\r\n//         return (\r\n//             <div className={'Slider'}\r\n//                  draggable={true}\r\n//                  onDragStart={this.onChange.bind(this)}\r\n//                  onDrag={this.onChange.bind(this)}\r\n//                  onMouseDown={this.send.bind(this)}\r\n//                  onClick={this.onChange.bind(this)}\r\n//             >\r\n//                 <div className={'bar'}>\r\n//                 </div>\r\n//                 <div className={'indicator'} style={{left:pos+\"%\"}}>\r\n//                 </div>\r\n//             </div>\r\n//         )\r\n//     }\r\n// }\r\n\r\nexport default class Effect extends Component {\r\n    constructor (props){\r\n        super(props)\r\n        let sliderValue = this.toSliderScale(this.props.value);\r\n        this.state = {value:this.props.value, sliderValue};\r\n\r\n        // TODO: fio more efficient rendering/state updating so these throttle times can be reduced\r\n        this.updateState = throttle(this._handleSliderChange,200);\r\n        this.handleInputChange = throttle(this._handleInputChange,200);\r\n    }\r\n\r\n    toSliderScale(x){\r\n        if (this.props.scale==='log'){\r\n            let range = this.props.max-this.props.min;\r\n            return Math.pow(x/range,0.5)*range;\r\n        }\r\n        return x\r\n    }\r\n\r\n    fromSliderScale(x){\r\n        if(this.props.scale==='log'){\r\n            let range = this.props.max-this.props.min;\r\n            return Math.round(Math.pow(x/range,2)*range*this.props.step)/this.props.step;\r\n        }\r\n        return x\r\n    }\r\n\r\n    render(){\r\n        return (this.props.isVertical?this.renderVertical():this.renderHorizontal())\r\n    }\r\n\r\n    _handleSliderChange(e, newValue){\r\n        if(newValue){\r\n            let newEffect = Object.assign({},this.props,{value:this.fromSliderScale(newValue)});\r\n            delete newEffect.updateEffect;\r\n            this.props.updateEffect(newEffect);\r\n        }\r\n    }\r\n\r\n    _handleInputChange(e){\r\n        let value = parseFloat(e.target.value);\r\n        let newEffect = Object.assign({},this.props,{value});\r\n        delete newEffect.updateEffect;\r\n        this.props.updateEffect(newEffect);\r\n    }\r\n\r\n    toggle(e){\r\n        let on = e.target.checked;\r\n        let newEffect = Object.assign({},this.props,{on});\r\n        delete newEffect.updateEffect;\r\n        this.props.updateEffect(newEffect);\r\n    }\r\n\r\n    renderHorizontal(){\r\n\r\n        return (\r\n            <div className={'Effect horizontal'}>\r\n                {this.props.name}\r\n                {this.props.noToggle ? null :\r\n                    <Switch\r\n                        color='primary'\r\n                        onChange={this.toggle.bind(this)}\r\n                        checked={this.props.on}\r\n                    />\r\n                }\r\n                <Grid container spacing={2} alignItems=\"center\">\r\n                    <Grid item xs>\r\n                        <Slider\r\n                            onChange={(e,newValue)=>{\r\n                                if(newValue){\r\n                                    this.setState({sliderValue:newValue,value:this.fromSliderScale(newValue)});\r\n                                    this.updateState(e,newValue);\r\n                                }\r\n                            }}\r\n                            min={this.props.min}\r\n                            max={this.props.max}\r\n                            step={this.props.step}\r\n                            value={parseFloat(this.state.sliderValue)}\r\n                        />\r\n                    </Grid>\r\n                    <Grid item>\r\n                        <Input\r\n                            margin=\"dense\"\r\n                            onChange={(e)=>{\r\n                                let value = parseFloat(e.target.value);\r\n                                e.persist()\r\n                                this.setState({value:value, sliderValue:this.toSliderScale(value)});\r\n                                this.handleInputChange.bind(this)(e);\r\n                            }}\r\n                            value={this.state.value}\r\n                            inputProps={{\r\n                                step: this.props.step,\r\n                                min: this.props.min,\r\n                                max: this.props.max,\r\n                                type: 'number',\r\n                                'aria-labelledby': 'input-slider',\r\n                            }}\r\n                        />\r\n                    </Grid>\r\n                </Grid>\r\n            </div>\r\n        )\r\n    }\r\n\r\n\r\n    renderVertical(){\r\n        return (\r\n            <div className={'Effect vertical'}>\r\n\r\n                <Slider\r\n                    orientation='vertical'\r\n                    onChange={(e,newValue)=>{\r\n                        if(newValue){\r\n                            this.setState({sliderValue:newValue,value:this.fromSliderScale(newValue)});\r\n                            this.updateState(e,newValue);\r\n                        }\r\n                    }}\r\n                    min={this.props.min}\r\n                    max={this.props.max}\r\n                    step={this.props.step}\r\n                    value={parseFloat(this.state.sliderValue)}\r\n                />\r\n                        <Input\r\n                            margin=\"dense\"\r\n                            onChange={(e)=>{\r\n                                let value = parseFloat(e.target.value);\r\n                                e.persist()\r\n                                this.setState({value:value, sliderValue:this.toSliderScale(value)});\r\n                                this.handleInputChange.bind(this)(e);\r\n                            }}\r\n                            value={this.props.value}\r\n                            inputProps={{\r\n                                step: this.props.step,\r\n                                min: this.props.min,\r\n                                max: this.props.max,\r\n                                type: 'number',\r\n                                'aria-labelledby': 'input-slider',\r\n                            }}\r\n                        />\r\n                        <div style={{textAlign:'center'}}>\r\n                            {this.props.name}\r\n                            {this.props.noToggle ? null :\r\n                                <Switch\r\n                                    color='primary'\r\n                                    onChange={this.toggle.bind(this)}\r\n                                    checked={this.props.on}\r\n                                />\r\n                            }\r\n                        </div>\r\n            </div>\r\n        )\r\n    }\r\n}","import React, {Component} from 'react'\r\nimport './index.css'\r\nimport Stem from '../Stem';\r\nimport PlusButton from \"../util/PlusButton/PlusButton\";\r\nimport Effect from \"../Effect\";\r\n\r\n\r\nexport default class Track extends Component{\r\n\r\n    shouldComponentUpdate(nextProps, nextState){\r\n        return JSON.stringify(nextProps) != JSON.stringify(this.props);\r\n        debugger\r\n        return nextProps!==this.props;\r\n    }\r\n\r\n\r\n    render(){\r\n        let stems = this.props.stems.map(x=>{\r\n            x.globalActions = this.props.globalActions;\r\n            return (<Stem key={x.id} {...x}/>)\r\n        });\r\n\r\n        return (\r\n            <div className='Track'>\r\n                <input onChange={this.titleChange.bind(this)} value={this.props.name}/>\r\n\r\n                <div className={'stems'}>\r\n                    {stems}\r\n                    <PlusButton onClick={this.addStem.bind(this)}/>\r\n                </div>\r\n                <div className={'effects'}>\r\n                    <div className={'launchButton'}>\r\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"var(--font-color-dark)\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path d=\"M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z\"/><path d=\"M0 0h24v24H0z\" fill=\"none\"/></svg>\r\n                    </div>\r\n                    <Effect isVertical noToggle updateEffect={this.updateEffect.bind(this)} {...this.props.effects[0]}/>\r\n                </div>\r\n\r\n            </div>\r\n        )\r\n    }\r\n\r\n\r\n    updateEffect(newEffect){\r\n        let newEffects = this.props.effects.map(x=>{\r\n            if(x.id===newEffect.id){\r\n                return newEffect\r\n            }\r\n            return x\r\n        });\r\n        this.props.globalActions.updateTrack({id:this.props.id,effects:newEffects})\r\n    }\r\n\r\n    addStem(){\r\n        this.props.globalActions.addStem(this.props.id);\r\n    }\r\n\r\n    titleChange(e){\r\n        this.props.globalActions.updateTrack({id:this.props.id,name:e.target.value});\r\n    }\r\n}","import React, { Component } from 'react';\r\nimport Track from '../Track';\r\nimport './index.css';\r\nimport PlusButton from \"../util/PlusButton/PlusButton\";\r\n\r\nexport default class LaunchSpace extends Component {\r\n\r\n    trackToDom(x){\r\n        x.globalActions = this.props.globalActions;\r\n        return (<Track key={x.id} {...x} />)\r\n    }\r\n\r\n    render(){\r\n        let tracks = this.props.tracks.map(this.trackToDom.bind(this));\r\n        return (\r\n            <div className=\"LaunchSpace\" style={this.props.style} tabIndex=\"1\" onKeyUp={this.onKeyUp.bind(this)}>\r\n                {tracks}\r\n                <PlusButton onClick={this.newTrack.bind(this)} style={{display:'inline-block',top:'0px',width:'50px',minWidth:'50px',height:'30px',margin:'5px'}}/>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    onKeyUp(e){\r\n        if(e.key.toLowerCase()==='delete'){\r\n            let selectedStems = this.props.tracks.map(x=>x.stems).flat().filter(x=>x.selected);\r\n            selectedStems.forEach(x=>{this.props.globalActions.removeStem(x.trackId,x.id)});\r\n        } else if (e.ctrlKey && e.key.toLowerCase()==='c'){\r\n            this.props.globalActions.copyStems();\r\n        } else if (e.key.toLowerCase()==='escape'){\r\n            let selectedStems = this.props.tracks.map(x=>x.stems).flat().filter(x=>x.selected);\r\n            selectedStems.forEach(x=>this.props.globalActions.updateStem(x.trackId,x.id,{selected:false}));\r\n        }\r\n    }\r\n\r\n    newTrack(){\r\n        this.props.globalActions.addTrack();\r\n    }\r\n\r\n}","import {store} from '../index.js';\r\n\r\n/*\r\nActions:\r\n______________\r\nadd track\r\nremove track\r\nadd stem\r\nremove stem\r\nupdate stem\r\nopen in flyout\r\nclose in flyout\r\nsave\r\nload\r\n\r\ncopy/paste\r\nmove stems around\r\nmove tracks around\r\n */\r\n\r\nconst Actions = {};\r\n\r\n// MASTER ACTIONS\r\nActions.CONNECT = function(url, port, isConnected){\r\n    return {type:'CONNECT', url, port, isConnected}\r\n};\r\n\r\nActions.UPDATE_TEMPO = function(tempo){\r\n    return {type:\"UPDATE_TEMPO\",tempo}\r\n};\r\nActions.UPDATE_BOOT_SCRIPT = function(bootScript){\r\n    return {type:'UPDATE_BOOT_SCRIPT',bootScript}\r\n}\r\n\r\n// copy's given stems. if no argument copy's selected stems\r\nActions.COPY_STEMS = function(opt_stems){\r\n    let stems = opt_stems;\r\n    if(!stems){\r\n        let state = store.getState();\r\n        stems = state.tracks.map(x=>x.stems).flat().filter(x=>x.selected);\r\n    }\r\n    return {type:\"COPY_STEMS\", stems};\r\n};\r\n\r\nActions.PASTE_STEMS = function(trackId, stemId){\r\n    return {type:\"PASTE_STEMS\",trackId,stemId}\r\n};\r\n\r\nActions.ADD_TRACK = function(){\r\n    return {type:'ADD_TRACK'}\r\n};\r\n\r\nActions.REMOVE_TRACK = function(trackId){\r\n    return {type:'ADD_TRACK', trackId};\r\n};\r\n\r\nActions.ADD_STEM = function(trackId){\r\n    return {type:'ADD_STEM',trackId};\r\n};\r\n\r\nActions.REMOVE_STEM = function(trackId, stemId){\r\n    return {type:'REMOVE_STEM', trackId, stemId};\r\n};\r\n\r\nActions.UPDATE_STEM = function(trackId,stemId, value){\r\n    return {type:'UPDATE_STEM', trackId, stemId, value}\r\n};\r\n\r\nActions.UPDATE_TRACK = function(value){\r\n    return {type:'UPDATE_TRACK', value}\r\n};\r\n\r\nActions.TOGGLE_LIVE = function(value){\r\n    return {type:'TOGGLE_LIVE',live:value};\r\n};\r\n\r\nActions.UPDATE_MASTER_EFFECT = function(value){\r\n    return {type:'UPDATE_MASTER_EFFECT', value}\r\n}\r\n\r\n\r\n// Saving / Loading\r\nActions.SAVE = function(){\r\n    return {type:'SAVE'}\r\n};\r\n\r\nActions.LOAD = function(newState){\r\n    return {type:'LOAD',newState}\r\n};\r\n\r\nActions.DOWNLOAD = function(){\r\n    return {type:'DOWNLOAD'}\r\n};\r\n\r\nActions.Types = {};\r\nObject.keys(Actions).forEach(x=>{\r\n    Actions.Types[x] = x;\r\n});\r\n\r\nexport default Actions","\r\nconst Connection = {};\r\n\r\nConnection.init = function(host=window.location.hostname,port=8000, onOpen=()=>{}, onClose=()=>{}, onErr=()=>{}){\r\n    if (Connection.ws){\r\n        Connection.ws.close();\r\n    }\r\n    window.WebSocket = window.WebSocket || window.MozWebSocket;\r\n\r\n    try{\r\n        Connection.ws = new WebSocket('ws://' + host + \":\" + port);\r\n        Connection.ws.isOpen = false;\r\n        Connection.ws.onopen = function open() {\r\n            Connection.ws.isOpen = true;\r\n            console.log('ws connection established');\r\n            onOpen();\r\n        }\r\n        Connection.ws.onerror = (e)=>{\r\n            console.warn(e);\r\n            onErr(e);\r\n        }\r\n        Connection.ws.onclose =  function incoming(data) {\r\n            console.warn('ws closed')\r\n            Connection.ws.isOpen = false;\r\n            onClose(data);\r\n        };\r\n    } catch (e) {\r\n        onErr();\r\n    }\r\n};\r\n\r\nConnection.sendCode = function(code){\r\n    if(!Connection.ws || !Connection.ws.isOpen){\r\n        console.warn('Connection is closed');\r\n        return;\r\n    }\r\n    Connection.ws.send(JSON.stringify({type:'eval',code}));\r\n};\r\n\r\nexport default Connection","import {uniqueId} from \"lodash\";\r\n\r\nexport const languages = [\"TidalCycles\",\"Hydra\"];\r\n\r\nvar State = {}\r\n\r\nState.getDefaultEffects = function (){\r\n    return [\r\n        {\r\n            name:'gain',\r\n            id:uniqueId(),\r\n            on:false,\r\n            scale:'linear',\r\n            operator: \"|*\",\r\n            value:1,\r\n            min:0,\r\n            max:2,\r\n            step:0.01\r\n        },\r\n        {\r\n            name:'lpf',\r\n            operator: \"#\",\r\n            id:uniqueId(),\r\n            on:false,\r\n            scale:'log',\r\n            value:22000,\r\n            min:0,\r\n            max:22000,\r\n            step:10\r\n        },\r\n        {\r\n            name:'hpf',\r\n            id:uniqueId(),\r\n            operator: \"#\",\r\n            on:false,\r\n            scale:'log',\r\n            value:0,\r\n            min:0,\r\n            max:22000,\r\n            step:10\r\n        }\r\n    ];\r\n}\r\n\r\nState.getDefaultTrack = function  (){\r\n    let id = uniqueId();\r\n    return {\r\n        id,\r\n        name:'New Track',\r\n        stems:([0,0,0,0,0]).map(x=>{return State.getDefaultStem(id)}),\r\n        effects:[\r\n            {\r\n                name:'gain',\r\n                id:uniqueId(),\r\n                on:true,\r\n                scale:'linear',\r\n                operator: \"|*\",\r\n                value:1,\r\n                min:0,\r\n                max:2,\r\n                step:0.01\r\n            }\r\n        ]\r\n    }\r\n}\r\n\r\nState.cloneStem = function(stem){\r\n    return {\r\n        ...stem,\r\n        effects:[...stem.effects].map(x=>{return Object.assign({},x)}),\r\n        id:uniqueId()\r\n    }\r\n}\r\n\r\nState.getDefaultStem = function  (trackId){\r\n    return {\r\n        id: uniqueId(),\r\n        trackId,\r\n        name:'',\r\n        on: false,\r\n        selected:false,\r\n        open:false,\r\n        live:false,\r\n        language:'TidalCycles',\r\n        code:\"\",\r\n        effects: State.getDefaultEffects()\r\n    }\r\n};\r\n\r\nState.defaultState = {\r\n    live:true,\r\n    tempo:120,\r\n    copy: null,\r\n    languages,\r\n    bootScript:'',\r\n    tracks: ([0,0,0,0,0]).map(x=>{return State.getDefaultTrack()}),\r\n    masterEffects:[\r\n        {\r\n            name:'gain',\r\n            id:uniqueId(),\r\n            on:false,\r\n            scale:'linear',\r\n            operator: \"|*\",\r\n            value:1,\r\n            min:0,\r\n            max:2,\r\n            step:0.01\r\n        },\r\n        {\r\n            name:'lpf',\r\n            operator: \"#\",\r\n            id:uniqueId(),\r\n            on:false,\r\n            scale:'log',\r\n            value:22000,\r\n            min:0,\r\n            max:22000,\r\n            step:10\r\n        },\r\n        {\r\n            name:'hpf',\r\n            id:uniqueId(),\r\n            operator: \"#\",\r\n            on:false,\r\n            scale:'log',\r\n            value:0,\r\n            min:0,\r\n            max:22000,\r\n            step:10\r\n        }\r\n    ],\r\n    connection:{\r\n        isConnected:false,\r\n        url:'127.0.0.1',\r\n        // url:'127.0.0.1',\r\n        port:8001\r\n    }\r\n    // connection:{\r\n    //     isConnected:false,\r\n    //     url:'192.168.0.117',\r\n    //     // url:'127.0.0.1',\r\n    //     port:8000\r\n    // }\r\n};\r\n\r\n\r\n\r\nState.getDefaultEffect = function (name='gain'){\r\n    return {\r\n        name,\r\n        id:uniqueId(),\r\n        on:false,\r\n        scale:'linear',\r\n        operator:\"|*\",\r\n        value:1,\r\n        min:0,\r\n        max:1,\r\n        step:0.01\r\n    }\r\n}\r\n\r\n\r\n\r\nexport default State","import Actions from './index.js';\r\nimport {store} from '../index.js';\r\nimport Connection from \"../Connection\";\r\nimport {uniqueId} from 'lodash';\r\nimport State from '../reducers/State.js'\r\n\r\n\r\nfunction reassignIDs(obj){\r\n    for (let i in obj){\r\n        if(i==='id'){\r\n            obj[i] = uniqueId();\r\n        } else if(typeof obj[i] === 'object'){\r\n            obj[i] = reassignIDs(obj[i]);\r\n        }\r\n    }\r\n    return obj\r\n}\r\n\r\nconst GlobalActions = dispatch=> {\r\n    return {\r\n        connect: (url,port)=>{\r\n            let onOpen = ()=>{\r\n                dispatch(Actions.CONNECT(url,port,true));\r\n            };\r\n            let onClose = ()=>{dispatch(Actions.CONNECT(url,port,false))};\r\n            let onError = onClose;\r\n            Connection.init(url,port, onOpen, onClose, onError);\r\n        },\r\n        updateTempo: (tempo)=>{\r\n            dispatch(Actions.UPDATE_TEMPO(tempo));\r\n        },\r\n        updateBootScript:(bootScript) =>{\r\n            dispatch(Actions.UPDATE_BOOT_SCRIPT(bootScript));\r\n        },\r\n        copyStems:(x)=>{\r\n            dispatch(Actions.COPY_STEMS(x))\r\n        },\r\n        pasteStems:(trackId, stemId)=>{\r\n            dispatch(Actions.PASTE_STEMS(trackId, stemId));\r\n            let state = store.getState();\r\n            state.tracks.forEach(track=>{\r\n                track.stems.filter(x=>x.selected).forEach(stem=>{\r\n                    dispatch(Actions.UPDATE_STEM(stem.trackId,stem.id,{selected:false}));\r\n                })\r\n            })\r\n        },\r\n        addTrack: ()=>{\r\n            dispatch(Actions.ADD_TRACK())\r\n        },\r\n        removeTrack: (trackId)=>{\r\n            dispatch(Actions.REMOVE_TRACK(trackId))\r\n        },\r\n        addStem: (trackId)=>{\r\n            dispatch(Actions.ADD_STEM(trackId))\r\n            // renderState(store.getState());\r\n        },\r\n        removeStem: (trackId, stemId)=>{\r\n            dispatch(Actions.REMOVE_STEM(trackId,stemId))\r\n            // renderState(store.getState());\r\n        },\r\n        updateStem: (trackId, stemId, value)=>{\r\n            dispatch(Actions.UPDATE_STEM(trackId, stemId, value));\r\n            // renderState(store.getState());\r\n        },\r\n        openInFlyout: (trackId, stemId)=> {\r\n            dispatch(Actions.OPEN_IN_FLYOUT(trackId,stemId))\r\n        },\r\n        updateTrack: (value)=>{\r\n            dispatch(Actions.UPDATE_TRACK(value))\r\n            // renderState(store.getState());\r\n        },\r\n        updateMasterEffect: (value)=>{\r\n            dispatch(Actions.UPDATE_MASTER_EFFECT(value));\r\n            // renderState(store.getState());\r\n        },\r\n        toggleLive: (value)=>{\r\n            dispatch(Actions.TOGGLE_LIVE(value))\r\n        },\r\n        save:()=>{\r\n            window.localStorage.setItem('state', JSON.stringify(store.getState()));\r\n            console.log('saved')\r\n        },\r\n        load: ()=>{\r\n            let newState = window.localStorage.getItem('state');\r\n            if(newState){\r\n                newState = JSON.parse(newState);\r\n                newState = reassignIDs(newState);\r\n                newState.tracks.forEach(track=>{\r\n                    track.stems.forEach(stem=>{\r\n                        stem.trackId = track.id\r\n                    });\r\n                });\r\n                dispatch(Actions.LOAD(State.defaultState));\r\n                dispatch(Actions.LOAD(newState));\r\n                // renderTempoChange(store.getState());\r\n                // renderBootScript(store.getState());\r\n            } else {\r\n                console.warn('Tried to load state but empty')\r\n            }\r\n        },\r\n        download: ()=>{\r\n            let dataStr = \"data:text/json;charset=utf-8,\" + encodeURIComponent(JSON.stringify(store.getState()));\r\n            let anchor = document.createElement('a')\r\n            anchor.setAttribute(\"href\", dataStr);\r\n            anchor.setAttribute(\"download\", \"dead_state.json\");\r\n            anchor.click();\r\n            dispatch(Actions.DOWNLOAD());\r\n        },\r\n        openFile: (file)=>{\r\n            if(!file){\r\n                let input = document.createElement('input');\r\n                input.type = 'file';\r\n                input.onchange = (e)=>{\r\n                    input.files[0].text().then(x=>{\r\n                        dispatch(Actions.LOAD(JSON.parse(x)));\r\n                    });\r\n                };\r\n                input.click();\r\n            } else {\r\n                file.text().then(x=>{\r\n                    dispatch(Actions.LOAD(JSON.parse(x)));\r\n                });\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\nexport default GlobalActions;","import LaunchSpace from '../components/LaunchSpace'\r\nimport GlobalActions from \"../actions/GlobalActions\";\r\nimport {connect} from 'react-redux';\r\n\r\nconst mapStateToProps = state => state;\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return {\r\n      globalActions: GlobalActions(dispatch)\r\n  }\r\n};\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps,\r\n)(LaunchSpace);","import React, {Component} from 'react'\r\nimport './index.css'\r\nimport debounce from \"lodash/debounce\";\r\nimport {Button, Switch} from \"@material-ui/core\";\r\n\r\nexport default class CodeEditor extends Component {\r\n\r\n    // onChange, onChangeLive, code, live\r\n    constructor(props){\r\n        super(props);\r\n\r\n        this.state = {code:this.props.code};\r\n        this.updateCode = debounce(this.props.onChange, 1000);\r\n        this.flashTimeout = null;\r\n    }\r\n\r\n    render(){\r\n\r\n        return (\r\n\r\n            <div className={'CodeEditor'}>\r\n                Live\r\n                <Switch\r\n                    color='primary'\r\n                    onChange={(e)=>{this.props.onChangeLive(e.target.checked)}}\r\n                    checked={this.props.live}\r\n                />\r\n                <Button color='primary' disabled={this.props.live} onClick={(e)=>{this.updateCode.bind(this)(e.target.value)}} variant='outlined'>eval</Button>\r\n\r\n                <textarea\r\n                    className={this.state.flash?'flash':''}\r\n                    onKeyPress={this.onKeyPress.bind(this)}\r\n                    onChange={(e)=>{\r\n                        this.setState({code:e.target.value});\r\n                        if(this.props.live){\r\n                            this.updateCode.bind(this)(e.target.value)\r\n                        }\r\n                    }\r\n                    }\r\n                    value={this.state.code}\r\n                />\r\n            </div>\r\n        )\r\n    }\r\n\r\n    onKeyPress(e) {\r\n        if(e.shiftKey){\r\n            if(e.key==='Enter'){\r\n                e.preventDefault();\r\n                this.props.onChange(this.state.code);\r\n                clearTimeout(this.flashTimeout);\r\n                this.setState({flash:true});\r\n                this.flashTimeout =  setTimeout(()=>{this.setState({flash:false})},1);\r\n            }\r\n        }\r\n    }\r\n}","import React, {Component} from 'react'\r\nimport './index.css'\r\nimport {TextField} from '@material-ui/core';\r\nimport debounce from 'lodash/debounce'\r\nimport Effect from '../Effect';\r\nimport CodeEditor from \"../CodeEditor\";\r\n\r\nexport default class MasterEditor extends Component {\r\n    constructor(props){\r\n        super(props);\r\n        this.state = {\r\n            connection:this.props.connection,\r\n            bootScript:this.props.bootScript,\r\n            bootScriptLive:false\r\n        };\r\n\r\n        this.updateBootScript = debounce((x)=>{\r\n            this.props.globalActions.updateBootScript(x)\r\n        },4000);\r\n\r\n        this.connect = debounce(()=>{\r\n            this.props.globalActions.connect(this.state.connection.url, this.state.connection.port)\r\n        },2000);\r\n    }\r\n\r\n    updateEffect(newEffect){\r\n        this.props.globalActions.updateMasterEffect(newEffect);\r\n    }\r\n\r\n    render(){\r\n        let effects = [];\r\n        for(let i=0; i < this.props.masterEffects.length; i++){\r\n            let effect = this.props.masterEffects[i];\r\n            effects.push(\r\n                <div key={effect.id} style={{margin:'5px',marginTop:'20px'}}>\r\n                    <Effect updateEffect={this.updateEffect.bind(this)} {...effect}/>\r\n                </div>\r\n                )\r\n        }\r\n\r\n        return (\r\n            <div className={'MasterEditor'} style={this.props.style}>\r\n                <div className='separator'>\r\n                    <h3>Effects</h3>\r\n                    {effects}\r\n                </div>\r\n                 <div className='separator'>\r\n                    <h3>Tempo</h3>\r\n                     <Effect\r\n                         key={Math.random()}\r\n                         noToggle\r\n                         name={'Tempo'}\r\n                         id={'tempo'}\r\n                         on={true}\r\n                         scale={'linear'}\r\n                         operator={''}\r\n                         min={0}\r\n                         max={200}\r\n                         value={this.props.tempo}\r\n                         step={0.01}\r\n                         updateEffect={this.changeTempo.bind(this)}\r\n                     />\r\n\r\n                </div>\r\n                <div className='separator'>\r\n                    <h3>Boot Script</h3>\r\n                    <CodeEditor\r\n                        key={Math.random()}\r\n                        onChange={(code)=>{this.props.globalActions.updateBootScript(code)}}\r\n                        onChangeLive={(bootScriptLive)=>{this.setState({bootScriptLive})}}\r\n                        code={this.props.bootScript}\r\n                        live={this.state.bootScriptLive}\r\n                    />\r\n\r\n                </div>\r\n\r\n                <div className='separator' style={{border:this.props.connection.isConnected?'1pt solid var(--stem-off)':'1pt solid red'}}>\r\n                    <h3>Connection</h3>\r\n                    <div>\r\n                        <TextField\r\n                            style={{width:'50%',marginLeft:'5px'}}\r\n                            label=\"URL\"\r\n                            value={this.state.connection.url}\r\n                            onChange={(e)=>{\r\n                                let connection = this.state.connection;\r\n                                connection.url = e.target.value;\r\n                                this.setState({connection});\r\n                                this.connect();\r\n                            }}\r\n                            margin=\"normal\"\r\n                        />\r\n                        <TextField\r\n                            style={{width:'50%',marginLeft:'5px',maxWidth:'100px'}}\r\n                            label=\"Port\"\r\n                            type='number'\r\n                            value={this.state.connection.port}\r\n                            onChange={(e)=>{\r\n                                let connection = this.state.connection;\r\n                                connection.port = parseInt(e.target.value);\r\n                                this.setState({connection});\r\n                                this.connect();\r\n                            }}\r\n                            margin=\"normal\"\r\n                        />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n\r\n    changeTempo(effect){\r\n        this.props.globalActions.updateTempo(effect.value);\r\n    }\r\n\r\n    connect(url=this.props.connection.url, port=this.props.connection.port){\r\n        let connection = {url:url,port:port,isConnected:this.state.isConnected};\r\n        this.setState({connection});\r\n        // this.props.globalActions.connect(url,port)\r\n        debounce(()=> {\r\n            this.props.globalActions.connect(url, port)\r\n        },3000, {trailing:true})();\r\n    }\r\n\r\n    updateConnect(url,port){\r\n        this.props.globalActions.connect(url,port)\r\n    }\r\n\r\n\r\n    toggle(e){\r\n        this.props.globalActions.toggleLive(e.target.checked)\r\n    }\r\n}","import React, {Component} from 'react'\r\nimport './index.css'\r\nimport {Button} from \"@material-ui/core\";\r\nimport Effect from \"../Effect\";\r\nimport debounce from 'lodash/debounce'\r\nimport CodeEditor from \"../CodeEditor\";\r\nimport {languages} from \"../../reducers/State\";\r\n\r\n\r\nexport default class StemEditor extends Component {\r\n    constructor(props){\r\n        super(props);\r\n        this.state = {code: this.props.code};\r\n        this.updateCode = debounce(this._updateCode, 1000);\r\n        this.textAreaRef = React.createRef();\r\n    }\r\n\r\n    render(){\r\n        let effects = [];\r\n        for(let e in this.props.effects){\r\n            let effect = this.props.effects[e];\r\n            // effects.push(\r\n            //     <div key={Math.random()} style={{marginTop:'20px'}}>\r\n            //         <Effect key={effect.id} updateEffect={this.updateEffect.bind(this)} {...effect}/>\r\n            //     </div>\r\n            // )\r\n            effects.push(\r\n                    <Effect key={effect.id} updateEffect={this.updateEffect.bind(this)} {...effect}/>\r\n            )\r\n        }\r\n\r\n        return (\r\n            <div className={'StemEditor'} style={this.props.style}>\r\n                Name:\r\n                <input\r\n                    style={{backgroundColor:'var(--stem-off)'}}\r\n                    onChange={this.updateName.bind(this)}\r\n                    type='text'\r\n                    value={this.props.name}\r\n                />\r\n\r\n                <select\r\n                    value={this.props.language}\r\n                    onChange={this.handleLanguageChange.bind(this)}\r\n                    name='language'\r\n                >\r\n                    {languages.map(x=><option key={x} value={x}>{x}</option>)}\r\n                </select>\r\n\r\n                <CodeEditor\r\n                    onChange={(code)=>this.props.globalActions.updateStem(this.props.trackId,this.props.id,{code})}\r\n                    onChangeLive={(live)=>this.props.globalActions.updateStem(this.props.trackId,this.props.id,{live})}\r\n                    code={this.props.code}\r\n                    live={this.props.live}\r\n                />\r\n                {effects}\r\n                <Button style={{marginTop:'5px'}} onClick={this.delete.bind(this)} color='primary' variant='outlined'>delete</Button>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    handleLanguageChange(e){\r\n        this.props.globalActions.updateStem(this.props.trackId,this.props.id, {language:e.target.value,code:''});\r\n    }\r\n\r\n    maybeEval(e) {\r\n        if(e.shiftKey){\r\n            if(e.key==='Enter'){\r\n                e.preventDefault();\r\n                this.props.globalActions.updateStem(this.props.trackId, this.props.id, {code:this.state.code});\r\n                this.textAreaRef.current.classList.add('flash');\r\n                setTimeout(()=>{this.textAreaRef.current.classList.remove('flash')},250);\r\n            }\r\n        }\r\n    }\r\n\r\n    delete(){\r\n        this.props.globalActions.removeStem(this.props.trackId, this.props.id);\r\n    }\r\n\r\n\r\n    updateLive(e){\r\n        this.props.globalActions.updateStem(this.props.trackId, this.props.id, {live:e.target.checked});\r\n    }\r\n\r\n    updateEffect(newEffect){\r\n        let newEffects = this.props.effects.map(x=>{\r\n            if(x.id===newEffect.id){\r\n                return newEffect\r\n            }\r\n            return x\r\n        });\r\n        this.props.globalActions.updateStem(this.props.trackId, this.props.id,{effects:newEffects})\r\n    }\r\n\r\n    updateName(e){\r\n        this.props.globalActions.updateStem(this.props.trackId, this.props.id, {name:e.target.value})\r\n    }\r\n\r\n    _updateCode(e){\r\n        this.props.globalActions.updateStem(this.props.trackId, this.props.id, {code:e.target.value})\r\n    }\r\n\r\n}","import React, {Component} from 'react';\r\nimport './index.css'\r\nimport MasterEditor from '../MasterEditor'\r\nimport StemEditor from \"../StemEditor\";\r\n\r\n// const CustomTab = withStyles({\r\n//     root: {\r\n//         color: '#black',\r\n//         opacity:0.4,\r\n//         minWidth:'80px',\r\n//         maxWidth:'130px',\r\n//         overflow:'hidden',\r\n//         padding:'2px',\r\n//         // borderRight:'1pt solid grey',\r\n//         textTransform: 'none',\r\n//         fontWeight:'regular',\r\n//         fontSize: '12px',\r\n//         // float:'left',\r\n//         fontFamily:'var(--font-family)',\r\n//         '&:focus': {\r\n//             opacity: 1,\r\n//         }\r\n//     }\r\n// })(props => {\r\n//     return (\r\n//         <div style={{padding:'5px'}}>\r\n//                 <Tab disableRipple {...props}/>\r\n//\r\n//             {true?null:\r\n//                 <IconButton\r\n//                     onClick={()=>{\r\n//                         props.globalActions.updateStem(props.trackId, props.id, {open:false});}\r\n//                     }\r\n//                     sizeSmall={{height:'10px'}}\r\n//                     style={{opacity:1,height:'10px'}} size={'small'} aria-label=\"close\">\r\n//                     <CloseIcon />\r\n//                 </IconButton>}\r\n//         </div>\r\n//     )\r\n// });\r\n// class TabBar extends Component {\r\n//     constructor (props){\r\n//         super(props)\r\n//     }\r\n//\r\n//     render(){\r\n//         return (\r\n//             <div className='TabBar'> this.props.label</div>\r\n//         )\r\n//     }\r\n// }\r\n\r\nclass Tab extends Component {\r\n    // constructor (props){\r\n    //     super(props)\r\n    // }\r\n\r\n    render(){\r\n        return (\r\n            <div onClick={this.props.switchToTab} className={'Tab'+(this.props.selected?'':' unselected')}>\r\n                <label>{this.props.label}</label>\r\n                {this.props.closeAble?\r\n                    <svg onClick={this.props.closeTab} xmlns=\"http://www.w3.org/2000/svg\" width=\"18\" height=\"18\" viewBox=\"0 0 18 18\">\r\n                        <path d=\"M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z\"/>\r\n                    </svg>:null}\r\n                {this.props.selected?<div className='indicator'/>:null}\r\n            </div>\r\n        )\r\n    }\r\n}\r\n\r\nexport default class Flyout extends Component{\r\n    constructor(props){\r\n        super(props);\r\n        this.state = {\r\n            tab:'master',\r\n            history:[]\r\n        }\r\n    }\r\n    switchTab(tab){\r\n        let opened = this._getOpenedStems().map(x=>x.id+\"_\"+x.trackId);\r\n        if(tab==='master' || opened.includes(tab)){\r\n            let history = this.state.history.concat([tab]);\r\n            this.setState({tab,history});\r\n        }\r\n    }\r\n\r\n    _getOpenedStems(){\r\n        return this.props.tracks.map(x=>x.stems).flat().filter(x=>x.open);\r\n    }\r\n\r\n    closeTab(trackId, stemId){\r\n\r\n        let tab, history;\r\n        if(this.state.history.length-1){\r\n            history = this.state.history.slice(0,-1);\r\n            history = history.filter(x=>x!==stemId+\"_\"+trackId);\r\n            tab = history[history.length-1] || 'master';\r\n        } else {\r\n            tab = 'master';\r\n            history = this.state.history;\r\n        }\r\n        this.setState({tab,history});\r\n        setTimeout(()=>{\r\n            this.props.globalActions.updateStem(trackId,stemId,{open:false});\r\n            this.setState({tab,history});\r\n        },1);\r\n    }\r\n\r\n    render(){\r\n        let openStems = this.props.tracks.map(x=>x.stems).flat().filter(x=>x.open);\r\n        if(this.state.tab!=='master' && !openStems.map(x=>x.id+\"_\"+x.trackId).includes(this.state.tab)){\r\n            this.switchTab('master');\r\n        }\r\n        let tabs = openStems.map(x=>{\r\n            let keyVal = x.id+'_'+x.trackId;\r\n            let tab = (\r\n                <Tab\r\n                    switchToTab={()=>{this.switchTab.bind(this)(keyVal)}}\r\n                    value={keyVal}\r\n                    label={x.name===''?'<untitled>':x.name}\r\n                    key={keyVal}\r\n                    trackId={x.trackId}\r\n                    id={x.id}\r\n                    selected={this.state.tab === keyVal}\r\n                    closeAble={true}\r\n                    closeTab={()=>{this.closeTab.bind(this)(x.trackId,x.id)}}\r\n                    {...this.props}/>);\r\n            let content = (<StemEditor\r\n                style={{display:(this.state.tab===keyVal?'block':'none')}}\r\n                value={keyVal}\r\n                key={keyVal}\r\n                {...x}\r\n                />\r\n                );\r\n            return {tab, content}\r\n        });\r\n\r\n\r\n        return (\r\n            <div className='Flyout' style={this.props.style}>\r\n                <div className={'scrollbarHidden'}>\r\n                    <div className={'TabContainer'}>\r\n                        <Tab\r\n                            switchToTab={()=>{this.switchTab.bind(this)('master')}}\r\n                            value={'master'}\r\n                            label='master'\r\n                            selected={this.state.tab==='master'}\r\n                        />\r\n                        {tabs.map(x=>x.tab)}\r\n                    </div>\r\n                </div>\r\n                <div className={'content'}>\r\n                    <MasterEditor\r\n                        {...this.props}\r\n                        value={'master'}\r\n                        style={{display:this.state.tab==='master'?'block':'none'}}\r\n                    />\r\n                    {tabs.map(x=>x.content)}\r\n                </div>\r\n\r\n            </div>\r\n        )\r\n    }\r\n}","import Flyout from '../components/Flyout'\r\nimport {connect} from 'react-redux';\r\nimport GlobalActions from \"../actions/GlobalActions\";\r\n\r\nconst mapStateToProps = state => state;\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n    return {\r\n        globalActions: GlobalActions(dispatch)\r\n    }\r\n};\r\n\r\n\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps,\r\n)(Flyout);","import React, {Component} from 'react'\r\nimport './index.css'\r\nimport Connection from \"../../Connection\";\r\nimport {Renderers} from \"../../Renderers\";\r\n\r\nexport default class Render extends Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.iframeRef = React.createRef();\r\n        this.tempo = '';\r\n        this.bootScript = props.bootScript;\r\n        this.tidalCode = '';\r\n        this.hydraCode = '';\r\n        this.poppedOut = [];\r\n    }\r\n\r\n    componentDidMount() {\r\n    }\r\n\r\n\r\n\r\n    render() {\r\n        var tidal = Renderers.TidalCycles.getCode(this.props);\r\n        // var hydra = Renderers.Hydra.getCode(this.props, \"add\");\r\n        // let send = false;\r\n\r\n        if(this.tempo!==this.props.tempo){\r\n            Connection.sendCode(Renderers.TidalCycles.getTempoCode(this.props));\r\n            this.tempo = this.props.tempo;\r\n        }\r\n\r\n        if(this.bootScript!==this.props.bootScript){\r\n            Connection.sendCode(this.props.bootScript);\r\n            this.bootScript = this.props.bootScript;\r\n        }\r\n\r\n        if (this.tidalCode !== tidal) {\r\n            console.log('tidal:', tidal);\r\n            Connection.sendCode(tidal);\r\n        }\r\n\r\n        this.tidalCode = tidal;\r\n        // this.hydraCode = hydra;\r\n\r\n        if(this.iframeRef.current && this.iframeRef.current.contentWindow){\r\n            // debugger;\r\n            const msg = JSON.parse(JSON.stringify(this.props));\r\n            this.iframeRef.current.contentWindow.postMessage({state:msg});\r\n            if(this.poppedOut.length){\r\n                this.poppedOut.forEach(iframe=>{iframe.postMessage({state:msg})});\r\n            }\r\n        }\r\n\r\n\r\n        return (\r\n            <div className=\"Render\" style={this.props.style}>\r\n                <svg onClick={this.popoutRender.bind(this)} xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\r\n                    <path d=\"M19 19H5V5h7V3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2v-7h-2v7zM14 3v2h3.59l-9.83 9.83 1.41 1.41L19 6.41V10h2V3h-7z\"/>\r\n                </svg>\r\n                <iframe title={\"Audience Render\"} ref={this.iframeRef} src={\"/render\"}/>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    popoutRender(){\r\n        this.poppedOut.push(window.open(\"/render\"));\r\n    }\r\n}","import Render from '../components/Render'\r\nimport {connect} from 'react-redux';\r\nimport GlobalActions from \"../actions/GlobalActions\";\r\n\r\nconst mapStateToProps = state => state;\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n    return {\r\n        globalActions: GlobalActions(dispatch)\r\n    }\r\n};\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps,\r\n)(Render);\r\n\r\n","import React, {Component} from 'react'\r\nimport LaunchSpace from '../../containers/LaunchSpace.jsx';\r\nimport Flyout from '../../containers/Flyout.jsx';\r\nimport Render from '../../containers/Render'\r\nimport './index.css';\r\n// import ResizeDivider from \"../ResizeDivider\";\r\n\r\nexport default class App extends Component{\r\n\r\n    constructor(props){\r\n        super(props)\r\n        this.state = {\r\n            divider:70, //%\r\n            horizontalDivider:75\r\n        }\r\n        this.appRef = React.createRef()\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.props.globalActions.connect(this.props.connection.url, this.props.connection.port);\r\n    }\r\n\r\n    render(){\r\n        return (\r\n            <div\r\n                onDragOver={(e)=>{e.preventDefault()}}\r\n                ref={this.appRef} className='App' tabIndex=\"0\" onKeyDown={this.macros.bind(this)}>\r\n                <LaunchSpace style={{width:this.state.divider+\"%\"}} />\r\n                {/*<ResizeDivider onResize={this.dividerResize.bind(this)}vertical/>*/}\r\n                <div id={\"rightPanel\"} style={{width:100-this.state.divider+\"%\"}}>\r\n                    <Flyout style={{height:this.state.horizontalDivider+\"%\"}}/>\r\n                    {/*<ResizeDivider horizontal onResize={this.dividerResizeRightPanel.bind(this)}/>*/}\r\n                    <Render style={{height:(100-this.state.horizontalDivider)+\"%\"}}/>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    dividerResize(px){\r\n        this.setState({divider:px*100/document.body.clientWidth})\r\n    }\r\n\r\n    dividerResizeRightPanel(px){\r\n        this.setState({horizontalDivider:px*100/document.body.clientHeight})\r\n    }\r\n\r\n\r\n    macros(e){\r\n        if(e.ctrlKey){\r\n            if(e.key==='s'){\r\n                e.preventDefault();\r\n                this.props.globalActions.save();\r\n            } else if (e.key ===\"l\"){\r\n                e.preventDefault();\r\n                this.props.globalActions.load();\r\n            } else if (e.key ===\"d\"){\r\n                e.preventDefault();\r\n                this.props.globalActions.download();\r\n            } else if (e.key ==='o'){\r\n                e.preventDefault();\r\n                this.props.globalActions.openFile();\r\n            }\r\n        }\r\n    }\r\n}","import App from '../components/App'\r\nimport {connect} from 'react-redux';\r\nimport GlobalActions from \"../actions/GlobalActions\";\r\n\r\nconst mapStateToProps = state => state;\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n    return {\r\n        globalActions: GlobalActions(dispatch)\r\n    }\r\n};\r\n\r\n\r\n\r\nexport default connect(\r\n    mapStateToProps,\r\n    mapDispatchToProps,\r\n)(App);","import React, {Component} from 'react'\r\nimport AudienceRenderComponent from \"../components/AudienceRender\";\r\n\r\nexport default class AudienceRender extends Component{\r\n\r\n    constructor(props){\r\n        super(props);\r\n        this.state = {};\r\n    }\r\n\r\n    componentDidMount() {\r\n        window.addEventListener('message',(e)=>{\r\n            if(e.origin!== window.location.origin) return;\r\n            this.setState(e.data.state);\r\n        })\r\n    }\r\n\r\n    render(){\r\n\r\n\r\n        return (\r\n                <AudienceRenderComponent {...this.state}/>\r\n        )\r\n    }\r\n\r\n}","import {render} from 'react-dom'\r\nimport {Provider} from 'react-redux'\r\nimport App from './containers/App';\r\nimport {applyMiddleware, createStore} from \"redux\";\r\nimport DeadReducer from './reducers'\r\nimport React from 'react';\r\nimport logger from 'redux-logger'\r\nimport {BrowserRouter as Router, Route} from \"react-router-dom\";\r\nimport AudienceRender from \"./containers/AudienceRender\";\r\n\r\nexport const store = createStore(DeadReducer, applyMiddleware(logger));\r\n\r\nrender(\r\n    (\r\n        <Router>\r\n            <Provider store={store}>\r\n                <Route path=\"/\" exact component={App}/>\r\n            </Provider>\r\n                <Route path=\"/render\" exact component={AudienceRender}/>\r\n        </Router>),\r\ndocument.getElementById('root')\r\n)","import Actions from '../actions'\r\nimport State from './State'\r\n\r\n\r\nexport default (state = State.defaultState, action) =>{\r\n    let oldTrack, newTrack, newState;\r\n\r\n    switch (action.type){\r\n        case Actions.Types.CONNECT:\r\n            let connection = {url: action.url, port:action.port, isConnected:action.isConnected};\r\n            return Object.assign({},state,{connection});\r\n        case Actions.Types.UPDATE_TEMPO:\r\n            return Object.assign({},state,{tempo:action.tempo});\r\n        case Actions.Types.ADD_TRACK:\r\n            return (Object.assign({}, state,{\r\n                tracks:[\r\n                    ...state.tracks,\r\n                    Object.assign({},State.getDefaultTrack())\r\n                ]\r\n            }));\r\n        case Actions.Types.REMOVE_TRACK:\r\n            newState =  Object.assign({},state,{\r\n               tracks: [...state.tracks].filter(x=>{return x.id !== action.trackId})\r\n            });\r\n            break;\r\n        case Actions.Types.UPDATE_BOOT_SCRIPT:\r\n            return Object.assign({},state,{bootScript:action.bootScript});\r\n        case Actions.Types.UPDATE_TRACK:\r\n            oldTrack = state.tracks.find(x=>{return x.id === action.value.id});\r\n            newTrack = Object.assign({},oldTrack,action.value);\r\n            return Object.assign({},state,{\r\n                tracks: state.tracks.map(x=>{\r\n                    if(x.id === newTrack.id){\r\n                        return newTrack\r\n                    }\r\n                    return x\r\n                })\r\n            });\r\n        case Actions.Types.COPY_STEMS:\r\n            return Object.assign({},state,{copy:action.stems});\r\n        case Actions.Types.PASTE_STEMS:\r\n            if(!state.copy.length) return state;\r\n\r\n            function getStemPosition(stem){\r\n                let trackIndex = state.tracks.findIndex(x=>x.id===stem.trackId);\r\n                let stemIndex = state.tracks[trackIndex].stems.findIndex(x=>x.id===stem.id);\r\n                return {trackIndex, stemIndex}\r\n            }\r\n\r\n            // function insertAt(list,pos, item){\r\n            //     return list.slice(0,pos).concat([item]).concat(list.slice(pos));\r\n            // }\r\n\r\n\r\n            function pasteStemAtPosition(state, stem, pos){\r\n                if(pos.trackIndex>=state.tracks.length) return state;\r\n                if(pos.stemIndex>=state.tracks[pos.trackIndex].stems.length) return state;\r\n                let track = state.tracks[pos.trackIndex];\r\n                let newStem = State.cloneStem(stem);\r\n                newStem.trackId = track.id;\r\n                newStem.open = false;\r\n                track.stems = state.tracks[pos.trackIndex].stems.concat([]);//insertAt(state.tracks[pos.trackIndex].stems,pos.stemIndex,newStem).concat([]);\r\n                track.stems[pos.stemIndex] = newStem;//insertAt(state.tracks[pos.trackIndex].stems,pos.stemIndex,newStem).concat([]);\r\n                // track.stems[pos.stemIndex] = insertAt(track.stems,pos.stemIndex,newStem);\r\n                return Object.assign({},state,{\r\n                    tracks:state.tracks.map(x=>{\r\n                        if(x.id===track.id){\r\n                            return track\r\n                        }\r\n                        return x\r\n                    })\r\n                })\r\n            }\r\n\r\n            // Top left from copied\r\n            // TODO: pretty sure this will just be first b.c. of how copy algorithm works\r\n            let anchorStem = state.copy[0];\r\n            let anchorPos = getStemPosition(anchorStem);\r\n            let insertPos = getStemPosition({trackId:action.trackId,id:action.stemId});\r\n            newState = Object.assign({},state);\r\n            state.copy.forEach(stem=>{\r\n               let position = getStemPosition(stem);\r\n               let relativePos = {\r\n                   trackIndex:position.trackIndex-anchorPos.trackIndex,\r\n                   stemIndex:position.stemIndex-anchorPos.stemIndex\r\n               };\r\n               let newPos = {\r\n                   trackIndex:insertPos.trackIndex+relativePos.trackIndex,\r\n                   stemIndex:insertPos.stemIndex+relativePos.stemIndex\r\n               };\r\n               newState = pasteStemAtPosition(newState, stem,newPos);\r\n            });\r\n\r\n            return Object.assign({},state,newState);\r\n        case Actions.Types.ADD_STEM:\r\n            oldTrack = state.tracks.find(x=>{return x.id === action.trackId});\r\n            newTrack = Object.assign({},oldTrack,{\r\n                stems:[\r\n                    ...oldTrack.stems,\r\n                    State.getDefaultStem(oldTrack.id)\r\n                ]\r\n            });\r\n            return Object.assign({}, state, {\r\n                tracks: [...state.tracks].map(x=>{return x.id===action.trackId?newTrack:x;})\r\n            });\r\n        case Actions.Types.REMOVE_STEM:\r\n            oldTrack = state.tracks.find(x=>{return x.id === action.trackId});\r\n            newTrack = Object.assign({},oldTrack,{\r\n                stems:[\r\n                    ...oldTrack.stems.filter(x=>{return x.id!==action.stemId})\r\n                ]\r\n            });\r\n            return Object.assign({}, state, {\r\n                tracks: state.tracks.map(x=>{return x.id===action.trackId?newTrack:x;})\r\n            });\r\n        case Actions.Types.UPDATE_STEM:\r\n            const index = state.tracks.findIndex(x=>{return x.id === action.trackId});\r\n            oldTrack = state.tracks[index];\r\n\r\n            newTrack = Object.assign({},oldTrack,{\r\n                stems: [...oldTrack.stems].map(x=>{\r\n                    if(x.id===action.stemId){\r\n                        return Object.assign({}, x, action.value);\r\n                    }\r\n                    return x\r\n                })\r\n            });\r\n            const newTracks = [...state.tracks];\r\n            // const newTracks = Object.assign({},state.tracks);\r\n            newTracks[index] = newTrack;\r\n            newState = Object.assign({},state);\r\n            newState.tracks = newTracks;\r\n            return newState\r\n            // state.tracks = newTracks;\r\n            // state.tracks[index] = newTrack;\r\n\r\n            // oldTrack.stems = oldTrack.stems.map(x=>{\r\n            //     if(x.id===action.stemId){\r\n            //         return Object.assign({}, x, action.value);\r\n            //     }\r\n            //     return x\r\n            // });\r\n            // state.tracks[index] = oldTrack;\r\n\r\n            // return state;\r\n            // debugger;\r\n            return Object.assign({},state);\r\n\r\n\r\n\r\n            // const oldTrack = state.tracks.find(x=>{return x.id === action.trackId});\r\n            // newTrack = Object.assign({},oldTrack,{\r\n            //     stems: [...oldTrack.stems].map(x=>{\r\n            //         if(x.id===action.stemId){\r\n            //             return Object.assign({}, x, action.value);\r\n            //         }\r\n            //         return x\r\n            //     })\r\n            // });\r\n            // return Object.assign({}, state, {\r\n            //     tracks: state.tracks.map(x=>{return x.id===action.trackId?newTrack:x;})\r\n            // });\r\n        case Actions.Types.UPDATE_MASTER_EFFECT:\r\n            let i = state.masterEffects.findIndex(x=>x.id===action.value.id);\r\n            state.masterEffects[i] = action.value;\r\n            // let newEffects = state.masterEffects.map(x=>{\r\n            //     if(action.value.id===x.id) {\r\n            //         x = action.value;\r\n            //     }\r\n            //     return X\r\n            // });\r\n            return Object.assign({}, state, {masterEffects: state.masterEffects.concat([])});\r\n        case Actions.Types.TOGGLE_LIVE:\r\n            return Object.assign({},state,{live:action.live});\r\n        case Actions.Types.SAVE:\r\n            // console.warn('Not yet implemented '+action.type);\r\n            return;\r\n        case Actions.Types.LOAD:\r\n            return Object.assign({},state,action.newState);\r\n        case Actions.Types.DOWNLOAD:\r\n            // no change to state here....\r\n            return state;\r\n        default:\r\n            console.warn('Unrecognized or unimplemented action: '+action.type);\r\n            return state;\r\n    }\r\n}\r\n\r\n\r\n/*\r\nActions:\r\n______________\r\nadd track\r\nadd stem row\r\nupdate value\r\nopen in flyout\r\nclose in flyout\r\nsave\r\nload\r\n\r\nStore:\r\n____________\r\n */\r\n","import React from \"react\";\r\nimport \"./index.css\";\r\nexport const Hydra = {\r\n    language:'Hydra',\r\n    getCode,\r\n    getAudienceDom,\r\n};\r\n\r\n\r\nfunction getAudienceDom(state){\r\n    return <div className={'code'}>{Hydra.getCode(state,\"add\")}</div>\r\n}\r\n\r\nfunction getCode(fullState, mixMethod){\r\n    let tracksCode = fullState.tracks.map((x)=>{return trackToCode(x,mixMethod)}).filter(x=>x!==null);\r\n    if(tracksCode.length<1){\r\n        return 'solid(0,0,0,0).out()'\r\n    };\r\n\r\n    let code = tracksCode[0];\r\n    for (let i = 1;i<tracksCode.length;i++){\r\n        code = `${code}.${mixMethod}(${tracksCode[i]})`\r\n    }\r\n\r\n    code = code+\".out()\";\r\n    return code;\r\n}\r\n\r\nfunction trackToCode(track,mixMethod){\r\n    let stemsCode = track.stems.filter(x=>{return x.on && x.language===\"Hydra\" && x.code !== ''}).map(stemToCode);\r\n    if(stemsCode.length<1){\r\n        return null\r\n    };\r\n\r\n    let code = stemsCode[0];\r\n    for (let i = 1;i<stemsCode.length;i++){\r\n        code = `${code}.${mixMethod}(${stemsCode[i]})`\r\n    }\r\n    return code;\r\n}\r\n\r\nfunction stemToCode(stem){\r\n    return stem.code;\r\n}","import React from \"react\";\r\nimport './index.css';\r\n\r\nexport const TidalCycles = {\r\n    language: 'TidalCycles',\r\n    getCode,\r\n    trackToCode,\r\n    getTempoCode,\r\n    getAudienceDom\r\n}\r\n\r\n// function getAudienceDom(state){\r\n//\r\n//     let masterEffects = state.masterEffects.map(effectToCode).join(\" $ \");\r\n//     masterEffects= masterEffects + (state.masterEffects.length?\" $ \":\"\");\r\n//\r\n//     let stack = <span>{`d1 ${masterEffects} stack [`}</span>\r\n//     let stems = state.tracks.map(t=>t.stems).flat().filter(x=>{return x.on && x.language==='TidalCycles'}).map(stem=>{\r\n//         return [\r\n//             <div key={stem.id} className={'indented'}>{stemToCode(stem)}</div>,\r\n//             (<div key={stem.id+\"_c\"} style={{display:'inline-block'}}>{','}</div>)\r\n//         ]\r\n//     });\r\n//\r\n//     stems = stems.flat();\r\n//     stems = stems.slice(0,-1);\r\n//\r\n//     return (\r\n//         <div>\r\n//             {stack}\r\n//             {stems}\r\n//             ]\r\n//         </div>\r\n//     )\r\n// }\r\n\r\nfunction getAudienceDom(state){\r\n    // let effects = state.masterEffects.filter(effect=>effect.on).map(effectToDom).filter(x=>{return x!=null});\r\n    let tracks = state.tracks.map(trackToDom).filter(x=>x);\r\n    tracks = tracks.map(x=>[x,\",\"]).flat().slice(0,-1);\r\n\r\n    let effects = state.masterEffects.filter(effect=>effect.on).map(effectToDom).filter(x=>x);\r\n    effects = effects.map(x=>{return [x,\" . \"]}).flat().slice(0,-1);\r\n\r\n\r\n    return (\r\n        <div className={'code TidalCycles'}>\r\n\r\n            d1 $ {effects} {effects.length?\"$\":\"\"} stack [\r\n            {tracks}\r\n            ]\r\n\r\n        </div>\r\n    )\r\n\r\n}\r\n\r\nfunction trackToDom(track){\r\n    let stems = track.stems.filter(stem=>{return stem.on && stem.language===\"TidalCycles\"}).map(stemToDom).filter(x=>x);\r\n    if(!stems.length){\r\n        return null;\r\n    }\r\n    stems = stems.map(x=>[x,\",\"]).flat().slice(0,-1);\r\n    let effects = track.effects.filter(effect=>effect.on).map(effectToDom).filter(x=>x);\r\n    effects = effects.map(x=>{return [x,\" . \"]}).flat().slice(0,-1);\r\n\r\n    return (\r\n        <div key={track.id} className=\"trackCode\">\r\n\r\n            {effects} {effects.length?\" $ \":\" \"}\r\n            stack [\r\n            {stems}\r\n            ]\r\n        </div>\r\n    )\r\n}\r\n\r\nfunction stemToDom(stem){\r\n    const code = stemToCode(stem);\r\n    if(code==='' || code ==='silence'){\r\n        return null;\r\n    }\r\n\r\n    let effects = stem.effects.filter(effect=>effect.on).map(effectToDom).filter(x=>x);\r\n    effects = effects.map(x=>{return [x,\" . \"]}).flat().slice(0,-1);\r\n    return (\r\n        <div key={stem.id} className=\"stemCode\">\r\n            {effects} {code}\r\n        </div>\r\n    )\r\n\r\n}\r\n\r\nfunction effectToDom(effect){\r\n    if (!effect.on) {return null}\r\n    let code = effectToCode(effect);\r\n    return (\r\n        <div className={'effectCode'}>{code}</div>\r\n    )\r\n}\r\n\r\n// function getAudienceDom(state){\r\n//\r\n//     let masterEffects = state.masterEffects.map(effectToCode).join(\" $ \");\r\n//     masterEffects= masterEffects + (state.masterEffects.length?\" $ \":\"\");\r\n//\r\n//     let stack = <span>{`d1 ${masterEffects} stack [`}</span>\r\n//     let stems = state.tracks.map(t=>t.stems).flat().filter(x=>{return x.on && x.language==='TidalCycles'}).map(stem=>{\r\n//         return [\r\n//             <div key={stem.id} className={'indented'}>{stemToCode(stem)}</div>,\r\n//             (<div key={stem.id+\"_c\"} style={{display:'inline-block'}}>{','}</div>)\r\n//                 ]\r\n//     });\r\n//\r\n//     stems = stems.flat();\r\n//     stems = stems.slice(0,-1);\r\n//\r\n//     return (\r\n//         <div>\r\n//             {stack}\r\n//             {stems}\r\n//                 ]\r\n//         </div>\r\n//     )\r\n// }\r\n\r\n// function renderTidalCyclesBootScript(state){\r\n//     Connection.sendCode(state.bootScript);\r\n// }\r\n//\r\n// function renderTidalCyclesTempoChange(state){\r\n//     Connection.sendCode(getTempoCode(state));\r\n// };\r\n\r\nfunction getTempoCode(state){\r\n    return 'setcps ' +state.tempo/60/2;\r\n}\r\n\r\n\r\nfunction effectToCode(x){\r\n    return `(${x.operator} ${x.name} ${x.value})`\r\n}\r\n\r\nfunction stemToCode(stem){\r\n    let effectsOn = stem.effects.filter(x=>x.on);\r\n    let code = effectsOn.map(effectToCode).join(\" $ \");\r\n    code += effectsOn.length?' $ ':'';\r\n    code += stem.code;\r\n    return code\r\n}\r\n\r\nfunction trackToCode(track){\r\n    let stemsCode = track.stems.filter(x=>{return x.on&&(x.language===\"TidalCycles\")&&x.code!==\"\"}).map(stemToCode).join(\", \");\r\n    if (stemsCode ===''){\r\n        return ''\r\n    }\r\n\r\n    let trackEffects = track.effects.map(effectToCode).join(\" $ \");\r\n    let effectsCode= trackEffects + (track.effects.length?\" $ \":\"\");\r\n    return `${effectsCode} stack [${stemsCode}]`;\r\n}\r\n\r\nfunction getCode(state){\r\n    let stems = 'stack [';\r\n    let tracks = state.tracks.map(trackToCode).filter(x=>x!=='');\r\n    stems += tracks.join(\", \")+']';\r\n\r\n    let onMasterEffects = state.masterEffects.filter(x=>x.on);\r\n    let masterEffects = onMasterEffects.map(effectToCode).join(\" $ \");\r\n\r\n    let code = `d1 $ ${masterEffects}${onMasterEffects.length?' $ ':''}${stems}`;\r\n    return code;\r\n}","import {Hydra} from \"./Hydra/Hydra\"\r\nimport {TidalCycles} from \"./TidalCycles\";\r\n\r\nexport const Renderers = {\r\n    Hydra,\r\n    TidalCycles\r\n}","import React, {Component} from 'react'\r\nimport Hydra from \"hydra-synth\";\r\nimport './index.css'\r\nimport {Renderers} from \"../../Renderers\";\r\n\r\nexport default class AudienceRender extends Component {\r\n\r\n    constructor(props) {\r\n        super(props)\r\n        this.hydraRef = React.createRef();\r\n\r\n        this.hydraCode = '';\r\n    }\r\n\r\n    componentDidMount() {\r\n        window.hydra = new Hydra({canvas: this.hydraRef.current});\r\n        // window.hydra.resize(this.hydraRef.current.getBoundingClientRect().width,this.hydraRef.current.getBoundingClientRect().height);\r\n    }\r\n\r\n\r\n    render() {\r\n\r\n        let hydraDom;\r\n        let tidalDom;\r\n        if (this.props.tracks) {\r\n            // debugger;\r\n            hydraDom = Renderers.Hydra.getAudienceDom(this.props);\r\n            tidalDom = Renderers.TidalCycles.getAudienceDom(this.props);\r\n\r\n            const hydraCode = Renderers.Hydra.getCode(this.props);\r\n            if (hydraCode !== this.hydraCode) {\r\n                try {;\r\n                    eval(hydraCode);\r\n                } catch (e) {\r\n                    console.warn(\"Hydra ERR:\", e);\r\n                }\r\n                this.hydraCode = hydraCode;\r\n            }\r\n        }\r\n\r\n        return (\r\n            <div className={'AudienceRender'}>\r\n                <canvas ref={this.hydraRef}></canvas>\r\n                <div className={\"code\"}>\r\n                    <div id='tidalcycles' className=\"column\">\r\n                        {tidalDom}\r\n                    </div>\r\n                    <div id='hydra' className=\"column\">\r\n                        {hydraDom}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n}"],"sourceRoot":""}