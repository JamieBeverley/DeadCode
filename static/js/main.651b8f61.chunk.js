(this.webpackJsonpdeadcode=this.webpackJsonpdeadcode||[]).push([[0],{105:function(e,t,a){},106:function(e,t,a){},108:function(e,t,a){},109:function(e,t,a){},110:function(e,t,a){},111:function(e,t,a){},112:function(e,t,a){},114:function(e,t,a){},12:function(e,t,a){"use strict";var n=a(4);var r={getNew:function(e,t){return{type:e,language:t,on:arguments.length>2&&void 0!==arguments[2]&&arguments[2],properties:arguments.length>3?arguments[3]:void 0}},clone:function(e){return Object(n.a)({},e,{propertes:Object(n.a)({},e.properties)})},Types:{CODE_TOGGLE:"CODE_TOGGLE",SLIDER:"SLIDER"},PropertySpec:{SLIDER:{code:"string",value:"float",operator:"string",min:"float",max:"float",step:"float",scale:"string"},CODE_TOGGLE:{code:"string"},CODE_SLIDER:{code:"string",indices:"array",value:"float",min:"float",max:"float",step:"float",scale:"string"}},util:{defaultEffects:{TidalCycles:function(){return[r.getNew(r.Types.SLIDER,"TidalCycles",!0,{code:"gain",value:1,operator:"|*",min:0,max:2,step:.01,scale:"linear"}),r.getNew(r.Types.SLIDER,"TidalCycles",!1,{code:"lpf",value:22e3,operator:"#",min:0,max:22e3,step:10,scale:"log"}),r.getNew(r.Types.SLIDER,"TidalCycles",!1,{code:"hpf",value:0,operator:"#",min:0,max:22e3,step:10,scale:"log"}),r.getNew(r.Types.SLIDER,"TidalCycles",!1,{code:"coarse",value:0,operator:"#",min:0,max:24,step:1,scale:"linear"}),r.getNew(r.Types.SLIDER,"TidalCycles",!1,{code:"room",value:0,operator:"#",min:0,max:1,step:.01,scale:"linear"}),r.getNew(r.Types.SLIDER,"TidalCycles",!1,{code:"size",value:0,operator:"#",min:0,max:1,step:.01,scale:"linear"}),r.getNew(r.Types.CODE_TOGGLE,"TidalCycles",!1,{code:""})]},Hydra:function(){return[r.getNew(r.Types.SLIDER,"Hydra",!1,{code:"kaleid",value:1,min:0,max:50,step:1,scale:"linear"}),r.getNew(r.Types.SLIDER,"Hydra",!1,{code:"pixelate",value:1,min:0,max:200,step:1,scale:"linear"})]}}}};t.a=r},123:function(e,t,a){},124:function(e,t,a){},125:function(e,t,a){},126:function(e,t,a){},127:function(e,t,a){},128:function(e,t,a){},129:function(e,t,a){},130:function(e,t,a){},131:function(e,t,a){},133:function(e,t,a){},159:function(e,t,a){},161:function(e,t,a){"use strict";a.r(t);var n=a(13),r=a(16),o=a(6),s=a(7),i=a(9),c=a(8),l=a(10),p=a(0),u=a.n(p),d=a(4),f=(a(105),a(106),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(c.a)(t).call(this,e))).holdTime=new Date,a.dragToggle=!1,a.ref=u.a.createRef(),a.timeout=null,a.touchMoveCount=0,a}return Object(l.a)(t,e),Object(s.a)(t,[{key:"flash",value:function(){var e=this;this.ref.current.classList.add("flash"),setTimeout((function(){e.ref.current.classList.remove("flash")}),500)}},{key:"onMouseDown",value:function(){var e=this;this.timeout=setTimeout((function(){e.openInFlyout()}),500),this.holdTime=new Date,this.dragToggle=!1}},{key:"onMouseUp",value:function(e){e.preventDefault(),this.touchMoveCount=0;var t=new Date;this.dragToggle||t-this.holdTime<500&&(clearTimeout(this.timeout),e.shiftKey?this.props.globalActions.stemUpdate(this.props.id,{selected:!this.props.selected}):e.button?e.preventDefault():this.toggle()),this.holdTime=t,this.dragToggle=!1}},{key:"onTouchMove",value:function(e){this.touchMoveCount++,e.preventDefault(),this.touchMoveCount>5&&(clearTimeout(this.timeout),this.dragToggle=!0)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout)}},{key:"render",value:function(){var e=this;return u.a.createElement("div",{ref:this.ref,className:"Stem noselect "+(this.props.highlight?"highlight":""),tabIndex:0,onKeyUp:this.onKeyUp.bind(this),onTouchStart:this.onMouseDown.bind(this),onTouchEnd:this.onMouseUp.bind(this),onTouchMove:this.onTouchMove.bind(this),onMouseDown:this.onMouseDown.bind(this),onMouseUp:this.onMouseUp.bind(this),onContextMenu:function(t){t.preventDefault(),e.openInFlyout()}},u.a.createElement("div",{className:"stemButton"+(this.props.selected?" selected":"")+(this.props.on?" on ":" off ")},u.a.createElement("div",{className:"verticalCenter",style:{width:"100%"}},this.props.name)))}},{key:"onKeyUp",value:function(e){e.ctrlKey&&"v"===e.key&&this.props.globalActions.stemPaste(this.props.id)}},{key:"onTouchStart",value:function(){this.toggle()}},{key:"mouseUp",value:function(e){e.shiftKey?this.props.globalActions.stemUpdate(this.props.id,{selected:!this.props.selected}):e.button?e.preventDefault():this.toggle()}},{key:"openInFlyout",value:function(){this.props.globalActions.stemUpdate(this.props.id,{open:!0})}},{key:"toggle",value:function(){this.props.globalActions.stemUpdate(this.props.id,{on:!this.props.on})}}]),t}(p.Component)),h=a(197),m={MIDI_UPDATE:{name:"MIDI_UPDATE",propogateToServer:!0},PUSH_STATE:{name:"PUSH_STATE",propogateToServer:!0},RECEIVE_STATE:{name:"RECEIVE_STATE",propogateToServer:!1},CONNECT:{name:"CONNECT",propogateToServer:!1},SAVE:{name:"SAVE",propogateToServer:!1},LOAD:{name:"LOAD",propogateToServer:!1},LOAD_FROM_SERVER:{name:"LOAD_FROM_SERVER",propogateToServer:!1},DOWNLOAD:{name:"DOWNLOAD",propogateToServer:!1},MASTER_UPDATE:{name:"MASTER_UPDATE",propogateToServer:!0},MASTER_ADD_EFFECT:{name:"MASTER_ADD_EFFECT",propogateToServer:!0},STEM_UPDATE:{name:"STEM_UPDATE",propogateToServer:!0},STEM_DELETE_EFFECT:{name:"STEM_DELETE_EFFECT",propogateToServer:!0},STEM_ADD_EFFECT:{name:"STEM_ADD_EFFECT",propogateToServer:!0},STEM_COPY:{name:"STEM_COPY",propogateToServer:!0},STEM_PASTE:{name:"STEM_PASTE",propogateToServer:!0},TRACK_UPDATE:{name:"TRACK_UPDATE",propogateToServer:!0},TRACK_DELETE_STEM:{name:"TRACK_DELETE_STEM",propogateToServer:!0},TRACK_ADD_STEM:{name:"TRACK_ADD_STEM",propogateToServer:!0},TRACK_DELETE_EFFECT:{name:"TRACK_DELETE_EFFECT",propogateToServer:!0},TRACK_ADD_EFFECT:{name:"TRACK_ADD_EFFECT",propogateToServer:!0},TRACK_ADD:{name:"TRACK_ADD",propogateToServer:!0},TRACK_DELETE:{name:"TRACK_DELETE",propogateToServer:!0},EFFECT_UPDATE:{name:"EFFECT_UPDATE",propogateToServer:!0},SETTINGS_UPDATE_STYLE:{name:"SETTINGS_UPDATE_STYLE",propogateToServer:!1}};var _={},v={},E=function(e){var t={propogateToServer:m[e].propogateToServer,fromServer:!1};v[function(e){var t=e.split("_");return(t=t.map((function(e){return e[0]+e.slice(1,e.length).toLowerCase()})))[0]=t[0].toLowerCase(),t.join("")}(e)]=Object(h.a)(e,(function(e){return e}),(function(){return t})),_[e]=e};for(var g in m)E(g);var b=a(44),y=a(23),C=function(e,t){var a=t.payload;if("TRACK_UPDATE"===t.type)return e[a.trackId]=Object.assign({},e[a.trackId],a.value),Object(d.a)({},e);if("TRACK_DELETE_STEM"===t.type)return e[a.trackId].stems=e[a.trackId].stems.filter((function(e){return e!==a.stemId})),e[a.trackId]=Object.assign({},e[a.trackId]),Object(d.a)({},e);if("TRACK_ADD_STEM"===t.type){var n=Object.assign({},e[a.trackId]);n.stems=n.stems.concat([a.stemId]);var r={};return r[a.trackId]=n,Object.assign({},e,r)}return"TRACK_DELETE_EFFECT"===t.type?(e[a.trackId]=Object(d.a)({},e[a.trackId]),e[a.trackId].effects=e[a.track].filter((function(e){return e!==a.effectId})),Object(d.a)({},e)):"TRACK_ADD_EFFECT"===t.type?(e[a.trackId]=Object(d.a)({},e[a.trackId]),e[a.trackId].effects.push(a.effectId),Object(d.a)({},e)):"TRACK_ADD"===t.type?(e[a.trackId]=a.value,Object(d.a)({},e)):e},O=function(e,t){switch(t.type){case"CONNECT":return{url:t.payload.url,port:t.payload.port,isConnected:t.payload.isConnected};default:return e}},T=function(e,t){var a;switch(t.type){case"MASTER_UPDATE":return a=Object.assign({},e[t.payload.language],t.payload.value),e[t.payload.language]=a,Object(d.a)({},e);case"MASTER_ADD_EFFECT":return(a=Object.assign({},e[t.payload.language])).effects=a.effects.concat([t.payload.effectId]),e[t.payload.language]=a,Object(d.a)({},e);default:return e}},k=function(e,t){var a=t.payload;return"STEM_UPDATE"===t.type?(e[a.stemId]=Object.assign({},e[a.stemId],a.value),Object(d.a)({},e)):"STEM_DELETE_EFFECT"===t.type?(e[a.stemId]=Object.assign({},e[a.stemId]),e[a.stemId].effects=e[a.stemId].effects.filter((function(e){return e!==a.effectId})),Object(d.a)({},e)):"STEM_ADD_EFFECT"===t.type?(e[a.stemId]=Object.assign({},e[a.stemId]),e[a.stemId].effects.push(a.effectId),Object(d.a)({},e)):"STEM_COPY"===t.type?e:"STEM_PASTE"===t.type?(console.log("paste not yet implemented"),e):"TRACK_ADD_STEM"===t.type?(e[a.stemId]=a.value,Object(d.a)({},e)):"TRACK_DELETE_STEM"===t.type?(delete e[a.stemId],Object(d.a)({},e)):e},j=function(e,t){return"EFFECT_UPDATE"===t.type?(e[t.payload.effectId]=Object.assign({},e[t.payload.effectId],t.payload.value),Object(d.a)({},e)):"STEM_ADD_EFFECT"===t.type?(e[t.payload.effectId]=t.payload.value,Object(d.a)({},e)):"STEM_DELETE_EFFECT"===t.type?(delete e[t.payload.effectId],Object(d.a)({},e)):"TRACK_ADD_EFFECT"===t.type?(e[t.payload.effectId]=t.payload.value,Object(d.a)({},e)):"TRACK_DELETE_EFFECT"===t.type?(delete e[t.payload.effectId],Object(d.a)({},e)):"MASTER_ADD_EFFECT"===t.type?(e[t.payload.effectId]=t.payload.value,Object(d.a)({},e)):e},S=function(e,t){switch(t.type){case"MIDI_UPDATE":return Object.assign({},e,t.payload);default:return e}},D=function(e,t){switch(t.type){case"SETTINGS_UPDATE_STYLE":var a=Object.assign({},e.style,t.payload);return Object.assign({},e,{style:a});default:return e}},A=function(e,t){return"STEM_COPY"===t.type?{type:"stems",items:t.payload.items}:e};console.log(y.a.defaultState);var w={init:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.location.hostname,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8e3,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};w.ws&&w.ws.close(),e="undefined"!==typeof window?window.WebSocket||window.MozWebSocket:a(107);try{w.ws=new e("ws://"+t+":"+n),w.ws.isOpen=!1,w.ws.onopen=function(){w.ws.isOpen=!0,console.log("ws connection established"),r()},w.ws.onmessage=w.onMessage,w.ws.onerror=function(e){console.warn(e),s(e)},w.ws.onclose=function(e){w.ws.isOpen=!1,o(e)}}catch(i){s()}},onMessage:function(e){var t=JSON.parse(e.data);if("action"===t.type){var a=t.action;a.meta=a.meta||{},a.meta.fromServer=!0,L.dispatch(a)}else console.warn("Unrecognized message type from WS server: "+t.type,t)},sendAction:function(e){if(w.ws&&w.ws.isOpen){var t={type:"action",action:e};w.ws.send(JSON.stringify(t))}else console.warn("Connection is closed")},sendCode:function(e){w.ws&&w.ws.isOpen?w.ws.send(JSON.stringify({type:"eval",code:e})):console.warn("Connection is closed")}},M=w,I=a(55),R=a.n(I),L=Object(b.createStore)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y.a.defaultState,t=arguments.length>1?arguments[1]:void 0;return"LOAD"===t.type?t.payload:t.type===m.RECEIVE_STATE.name?Object(d.a)({},t.payload,{connection:e.connection}):{copy:A(e.copy,t),master:T(e.master,t),connection:O(e.connection,t),tracks:C(e.tracks,t),stems:k(e.stems,t),effects:j(e.effects,t),midi:S(e.midi,t),settings:D(e.settings,t)}}),Object(b.applyMiddleware)((function(e){return function(e){return function(t){var a=t.meta;if(!a.fromServer&&a.propogateToServer){var n=Object(d.a)({},t);n.type===m.PUSH_STATE.name&&(n.type=m.RECEIVE_STATE.name),M.sendAction(n)}return e(t)}}}),R.a)),U=a(22),P=a(12),x=a(45),N=a(54);function K(e,t){var a=Object.keys(e.tracks).findIndex((function(a){return e.tracks[a].stems.includes(t)}));return{track:a,stem:e.tracks[Object.keys(e.tracks)[a]].stems.findIndex((function(e){return e===t}))}}var F=function e(t){return{pushState:function(){var e=Object(d.a)({},L.getState(),{connection:void 0});t(v.pushState(e))},receiveState:function(e){t(v.receiveState(e))},connect:function(e,a){var n=v,r=function(){t(n.connect({url:e,port:a,isConnected:!1}))},o=r;M.init(e,a,(function(){t(v.connect({url:e,port:a,isConnected:!0}))}),r,o)},stemCopy:function(){var e=L.getState(),a=Object.keys(e.stems).filter((function(t){return e.stems[t].selected}));t(v.stemCopy({items:a}))},stemPaste:function(a){var n=L.getState();if(!n.copy||n.copy.items.length<1)console.log("nothing copied");else{var r=K(n,a),o=e(t),s=K(n,n.copy.items[0]),i=r.track-s.track,c=r.stem-s.stem;n.copy.items.forEach((function(e){var t=K(n,e),a=t.track+i,r=t.stem+c;if(a>=Object.keys(n.tracks).length)console.log("too long");else{for(var s=Object.keys(n.tracks)[a];r>=n.tracks[s].stems.length;)o.trackAddStem(s),n=L.getState();var l=n.tracks[s].stems[r];o.stemUpdate(l,n.stems[e])}}))}},save:function(){window.localStorage.setItem("state",JSON.stringify(L.getState())),console.log("saved")},load:function(){var e=window.localStorage.getItem("state");e?(e=JSON.parse(e),U.a.init(e),t(v.load(e))):console.warn("Tried to load state but empty")},loadFromServer:function(){M.sendAction({type:m.LOAD_FROM_SERVER.name,meta:{propogateToServer:!0,fromServer:!1}})},open:function(e){if(e)e.text().then((function(e){t(v.load(JSON.parse(e)))}));else{var a=document.createElement("input");a.type="file",a.onchange=function(e){a.files[0].text().then((function(e){var a=JSON.parse(e);U.a.init(a),t(v.load(a))}))},a.click()}},download:function(){var e="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(L.getState())),a=document.createElement("a");a.setAttribute("href",e),a.setAttribute("download","dead_state.json"),a.click(),t(v.download())},masterUpdate:function(e,a){t(v.masterUpdate({language:e,value:a}))},masterAddEffect:function(e,a,n,r){var o=U.a.new(),s=P.a.getNew(e,a,n,r);t(v.masterAddEffect({language:a,effectId:o,value:s}))},stemUpdate:function(e,a){t(v.stemUpdate({stemId:e,value:a}))},stemUpdateLanguage:function(a,n){var r=L.getState().stems[a],o=e(t);r.language!==n&&(r.effects.forEach((function(e){o.stemDeleteEffect(a,e)})),P.a.util.defaultEffects[n]().forEach((function(e){o.stemAddEffect(a,e.type,e.language,e.on,e.properties)})),o.stemUpdate(a,{language:n}))},stemDeleteEffect:function(e,a){t(v.stemDeleteEffect({stemId:e,effectId:a}))},stemAddEffect:function(e,a,n,r,o){var s=U.a.new(),i=P.a.getNew(a,n,r,o);t(v.stemAddEffect({stemId:e,effectId:s,value:i}))},trackUpdate:function(e,a){t(v.trackUpdate({trackId:e,value:a}))},trackDeleteStem:function(e,a){if(void 0===e){var n=L.getState();e=Object.keys(n.tracks).find((function(e){return n.tracks[e].stems.includes(a)}))}t(v.trackDeleteStem({trackId:e,stemId:a}))},trackAddStem:function(a){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"TidalCycles",r=U.a.new(),o=x.a.getNew(n);t(v.trackAddStem({trackId:a,stemId:r,value:o})),P.a.util.defaultEffects[n]().forEach((function(a){e(t).stemAddEffect(r,a.type,a.language,a.on,a.properties)}))},trackDeleteEffect:function(e,a){t(v.trackDeleteEffect({trackId:e,effectId:a}))},trackAddEffect:function(e){var a=U.a.new(),n=P.a.getNew(P.a.Types.SLIDER,"TidalCycles",!0,{code:"gain",value:1,operator:"|*",min:0,max:2,step:.01,scale:"linear"});t(v.trackAddEffect({trackId:e,effectId:a,value:n}))},trackAdd:function(a){var n=N.a.getNew(a),r=U.a.new();t(v.trackAdd({trackId:r,value:n}));var o=e(t);[0,0,0,0,0].forEach((function(){o.trackAddStem(r)})),o.trackAddEffect(r)},trackDelete:function(a){var n=L.getState().tracks[a],r=e(t);n.stems.forEach((function(e){r.trackDeleteStem(a,e)})),t(v.trackDelete({trackId:a}))},effectUpdate:function(e,a){t(v.effectUpdate({effectId:e,value:a}))},settingsUpdateStyle:function(e){t(v.settingsUpdateStyle({value:e}))}}},H=Object(r.b)((function(e,t){return Object(d.a)({},e.stems[t.id],{},t)}),(function(e){return{globalActions:F(e)}}))(f),W=(a(108),function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return u.a.createElement("div",Object.assign({},this.props,{className:"plusButton"}),u.a.createElement("div",null,"+"))}}]),t}(p.Component)),B=(a(109),a(110),a(190)),z=a(198),V=a(194),G=(a(111),function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"onClick",value:function(){this.props.onChange?this.props.onChange(!this.props.on):console.warn("no onChange for toggle")}},{key:"render",value:function(){return u.a.createElement("div",{onContextMenu:this.onClick.bind(this),onClick:this.onClick.bind(this),className:"Toggle"+(this.props.on?" on":"")},u.a.createElement("div",null))}}]),t}(p.Component)),q=function(e){function t(e){var a;Object(o.a)(this,t);var n=(a=Object(i.a)(this,Object(c.a)(t).call(this,e))).toSliderScale(a.props.properties.value);return a.state={value:a.props.properties.value,sliderValue:n},a}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e,t,a){if(this.props.properties.value!==e.properties.value){var n=this.toSliderScale(this.props.properties.value);this.setState({value:this.props.properties.value,sliderValue:n})}}},{key:"toSliderScale",value:function(e){if("log"===this.props.properties.scale){var t=this.props.properties.max-this.props.properties.min;return Math.pow(e/t,.5)*t}return e}},{key:"fromSliderScale",value:function(e){if("log"===this.props.properties.scale){var t=this.props.properties.max-this.props.properties.min;return Math.round(Math.pow(e/t,2)*t*this.props.properties.step)/this.props.properties.step}return e}},{key:"render",value:function(){return this.props.isVertical?this.renderVertical():this.renderHorizontal()}},{key:"handleSliderChange",value:function(e,t){if(t){var a=this.props.properties;a.value=t,this.props.globalActions.effectUpdate(this.props.id,{properties:a})}}},{key:"handleInputChange",value:function(e){var t=parseFloat(e.target.value),a=this.props.properties;a.value=t,this.props.globalActions.effectUpdate(this.props.id,{properties:a})}},{key:"toggle",value:function(e){this.props.globalActions.effectUpdate(this.props.id,{on:e})}},{key:"renderHorizontal",value:function(){var e=this;return u.a.createElement("div",{className:"Slider horizontal"},this.props.noToggle?null:u.a.createElement(G,{onChange:this.toggle.bind(this),on:this.props.on}),u.a.createElement("div",{className:"text"},u.a.createElement("div",null,this.props.properties.code)),u.a.createElement(B.a,{container:!0,spacing:2,alignItems:"center"},u.a.createElement(B.a,{item:!0,xs:!0},u.a.createElement(z.a,{onChange:function(t,a){a&&(e.setState({sliderValue:a,value:e.fromSliderScale(a)}),e.handleSliderChange(t,a))},min:this.props.properties.min,max:this.props.properties.max,step:this.props.properties.step,value:parseFloat(this.state.sliderValue)})),u.a.createElement(B.a,{item:!0},u.a.createElement("input",{margin:"dense",onInput:function(t){var a=parseFloat(t.target.value);t.persist(),e.setState({value:a,sliderValue:e.toSliderScale(a)}),e.handleInputChange.bind(e)(t)},value:this.state.value,step:this.props.properties.step,min:this.props.properties.min,max:this.props.properties.max,type:"number"}))))}},{key:"renderVertical",value:function(){var e=this;return u.a.createElement("div",{className:"Slider vertical"},u.a.createElement(z.a,{orientation:"vertical",onChange:function(t,a){a&&(e.setState({sliderValue:a,value:e.fromSliderScale(a)}),e.handleSliderChange(t,a))},min:this.props.properties.min,max:this.props.properties.max,step:this.props.properties.step,value:parseFloat(this.state.sliderValue)}),u.a.createElement(V.a,{margin:"dense",onChange:function(t){var a=parseFloat(t.target.value);t.persist(),e.setState({value:a,sliderValue:e.toSliderScale(a)}),e.handleInputChange.bind(e)(t)},value:this.state.value,inputProps:{step:this.props.properties.step,min:this.props.properties.min,max:this.props.properties.max,type:"number","aria-labelledby":"input-slider"}}),u.a.createElement("div",{style:{textAlign:"center"}},this.props.properties.code,this.props.noToggle?null:u.a.createElement(G,{onChange:this.toggle.bind(this),on:this.props.on})))}}]),t}(p.Component),J=(a(112),a(76)),$=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(c.a)(t).call(this,e))).state={code:a.props.properties.code},a.effectUpdate=Object(J.debounce)((function(e){a.props.globalActions.effectUpdate(a.props.id,{properties:{code:e}})}),500),a}return Object(l.a)(t,e),Object(s.a)(t,[{key:"onChange",value:function(e){var t=e.target.value;this.setState({code:t}),this.effectUpdate(t)}},{key:"onToggle",value:function(e){this.props.globalActions.effectUpdate(this.props.id,{on:e})}},{key:"componentDidUpdate",value:function(e,t,a){e.properties.code!==this.props.properties.code&&this.props.properties.code!==this.state.code&&this.setState(Object(d.a)({},this.state,{code:this.props.properties.code}))}},{key:"render",value:function(){return u.a.createElement("div",{className:"CodeToggle"},u.a.createElement("div",null,u.a.createElement(G,{on:this.props.on,onChange:this.onToggle.bind(this)}),u.a.createElement("div",{className:"text"},u.a.createElement("div",null,"Code Toggle"))),u.a.createElement("div",null,u.a.createElement("input",{type:"text",onChange:this.onChange.bind(this),value:this.state.code})))}}]),t}(p.Component),Y=(a(114),a(29)),Q=a.n(Y),X=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(c.a)(t).call(this,e))).state={width:0},a.spanRef=u.a.createRef(),a}return Object(l.a)(t,e),Object(s.a)(t,[{key:"onChange",value:function(e){this.spanRef.current.innerText=e.target.value;var t=this.spanRef.current.scrollWidth;this.setState({width:t}),this.props.onChange(e)}},{key:"render",value:function(){var e=this.props.style||{};return e.width=this.state.width+"px",u.a.createElement("div",null,u.a.createElement("input",Object.assign({},this.props,{style:e,onChange:this.onChange.bind(this)})),u.a.createElement("span",{ref:this.spanRef,style:{color:"transparent",backgroundColor:"transparent",pointerEvents:"none",position:"absolute"}},this.props.value))}}]),t}(p.Component),Z=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(c.a)(t).call(this,e))).state={text:a.props.text,indices:a.props.indices},a.onChange=Q()(a._onChange,500),a}return Object(l.a)(t,e),Object(s.a)(t,[{key:"_onChange",value:function(){}},{key:"textChange",value:function(e){}},{key:"render",value:function(){var e=this,t=0,a=[u.a.createElement(X,{onChange:this.textChange.bind(this),key:t+"text",className:"text"})];t++;var n=this.state.text;return this.state.indices.forEach((function(r){var o=n.slice(0,r),s=n.slice(r);n=s,a.push(u.a.createElement(X,{onChange:e.textChange.bind(e),key:t+"text",className:"text",value:o})),a.push(u.a.createElement(X,{key:t+"placeholder",className:"placeholder",value:e.props.value})),t++})),a.push(u.a.createElement(X,{onChange:this.textChange.bind(this),key:t+"text",className:"text",value:n})),u.a.createElement("div",{className:"TemplateInput"},u.a.createElement("div",{className:"text"},a),u.a.createElement("button",null,"insert"))}}]),t}(p.Component),ee=(p.Component,function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e;return this.props.type===P.a.Types.SLIDER?e=u.a.createElement(q,this.props):this.props.type===P.a.Types.CODE_TOGGLE&&(e=u.a.createElement($,this.props)),u.a.createElement("div",{className:"Effect",id:this.props.id},e)}}]),t}(p.Component)),te=Object(r.b)((function(e,t){return Object(d.a)({},e.effects[t.id],{},t)}),(function(e){return{globalActions:F(e)}}))(ee),ae=function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"stemToComponent",value:function(e,t){var a=t<this.props.midi.top+this.props.midi.rows&&t>=this.props.midi.top&&this.props.index<this.props.midi.left+this.props.midi.columns&&this.props.index>=this.props.midi.left;return u.a.createElement(H,{key:e,id:e,highlight:a})}},{key:"render",value:function(){var e=this.props.stems.map(this.stemToComponent.bind(this));return u.a.createElement("div",{className:"Track"},u.a.createElement("input",{onChange:this.titleChange.bind(this),value:this.props.name}),u.a.createElement("div",{style:{position:"relative",height:"100%"}},u.a.createElement("div",{className:"stems"},e,u.a.createElement("div",{style:{padding:"5px"}},u.a.createElement(W,{onClick:this.addStem.bind(this)}))),u.a.createElement("div",{className:"effects"},u.a.createElement("div",{className:"launchButton"},u.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"var(--font-color-dark)",width:"24",height:"24",viewBox:"0 0 24 24"},u.a.createElement("path",{d:"M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"}),u.a.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))),u.a.createElement(te,{isVertical:!0,noToggle:!0,updateEffect:this.updateEffect.bind(this),id:this.props.effects[0]}))))}},{key:"updateEffect",value:function(e){this.props.globalActions.trackUpdate(this.props.id,{effects:[e]})}},{key:"addStem",value:function(){this.props.globalActions.trackAddStem(this.props.id)}},{key:"titleChange",value:function(e){this.props.globalActions.trackUpdate(this.props.id,{name:e.target.value})}}]),t}(p.Component),ne=Object(r.b)((function(e,t){var a=Object.keys(e.tracks).findIndex((function(e){return e===t.id})),n=e.tracks[t.id];return Object(d.a)({},n,{},t,{midi:e.midi,index:a})}),(function(e){return{globalActions:F(e)}}))(ae),re=(a(123),function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"trackToDom",value:function(e){return e.globalActions=this.props.globalActions,u.a.createElement(ne,Object.assign({key:e.id},e))}},{key:"trackIdToComponent",value:function(e){return u.a.createElement(ne,{key:e,id:e})}},{key:"render",value:function(){var e=Object.keys(this.props.tracks).map(this.trackIdToComponent.bind(this));return u.a.createElement("div",{className:"LaunchSpace",style:this.props.style,tabIndex:"1",onKeyUp:this.onKeyUp.bind(this)},e,u.a.createElement(W,{onClick:this.newTrack.bind(this),style:{display:"inline-block",top:"0px",width:"50px",minWidth:"50px",height:"30px",margin:"5px"}}))}},{key:"onKeyUp",value:function(e){var t=this;if("delete"===e.key.toLowerCase())Object.keys(this.props.tracks).map((function(e){return t.props.tracks[e].stems.map((function(a){return{trackId:e,stemId:a,selected:t.props.stems[a].selected}}))})).flat().filter((function(e){return e.selected})).forEach((function(e){t.props.globalActions.trackDeleteStem(e.trackId,e.stemId)}));else if(e.ctrlKey&&"c"===e.key.toLowerCase())this.props.globalActions.stemCopy();else if("escape"===e.key.toLowerCase()){Object.keys(this.props.stems).filter((function(e){return t.props.stems[e].selected})).forEach((function(e){return t.props.globalActions.stemUpdate(e,{selected:!1})}))}}},{key:"newTrack",value:function(){this.props.globalActions.trackAdd()}}]),t}(p.Component)),oe=Object(r.b)((function(e,t){return e}),(function(e){return{globalActions:F(e)}}))(re),se=(a(124),a(125),a(126),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(c.a)(t).call(this,e))).state={code:a.props.code},a.updateCode=Q()(a.props.onChange,1e3),a.flashTimeout=null,a}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e,t,a){e.code!==this.props.code&&this.props.code!==this.state.code&&this.setState({code:this.props.code})}},{key:"render",value:function(){var e=this;return u.a.createElement("div",{className:"CodeEditor"},u.a.createElement("div",{className:"Liveness"},u.a.createElement("div",null,u.a.createElement("div",{className:"verticalCenter"},"Live")),u.a.createElement(G,{onChange:function(t){e.props.onChangeLive(t)},on:this.props.live}),u.a.createElement("button",{disabled:this.props.live,onClick:function(t){e.props.onChange(e.state.code)}},"eval")),u.a.createElement("textarea",{className:this.state.flash?"flash":"",onKeyPress:this.onKeyPress.bind(this),onChange:function(t){e.setState({code:t.target.value}),e.props.live&&e.updateCode.bind(e)(t.target.value)},value:this.state.code}))}},{key:"onKeyPress",value:function(e){var t=this;e.shiftKey&&"Enter"===e.key&&(e.preventDefault(),this.props.onChange(this.state.code),clearTimeout(this.flashTimeout),this.setState({flash:!0}),this.flashTimeout=setTimeout((function(){t.setState({flash:!1})}),1))}}]),t}(p.Component));a(127);var ie=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(c.a)(t).call(this,e))).ref=u.a.createRef(),a.state={creating:!1,progress:"plus",type:null},a}return Object(l.a)(t,e),Object(s.a)(t,[{key:"transitionToSpec",value:function(){var e=this.ref.current.querySelector("#effect_creator_type_input");if(e){var t=e.value;this.setState({type:t,progress:"spec"})}else console.warn("this shouldnt happen")}},{key:"render",value:function(){var e=this,t=[];if("plus"===this.state.progress)t.push(u.a.createElement("button",{key:"plus",onClick:function(){e.setState({progress:"type"})}}," + "));else if("type"===this.state.progress){var a=[];Object.keys(P.a.Types).forEach((function(e){e=P.a.Types[e],a.push(u.a.createElement("option",{key:e,value:e},e.toLowerCase()))}));var n=u.a.createElement("select",{key:"effect_creator_type_input",id:"effect_creator_type_input"},a),r=u.a.createElement("button",{key:"effect_creator_next",onClick:this.transitionToSpec.bind(this)}," next "),o=u.a.createElement("button",{key:"effect_creator_cancel",onClick:function(){e.setState({progress:"plus"})}}," cancel ");t.push([n,r,o])}else if("spec"===this.state.progress){var s=[];Object.keys(P.a.PropertySpec[this.state.type]).forEach((function(t){var a=function(e,t){return{array:u.a.createElement("input",{placeholder:"array",id:e,className:"specInput",type:"text"}),string:u.a.createElement("input",{placeholder:"string",id:e,className:"specInput",type:"text"}),float:u.a.createElement("input",{placeholder:"float",id:e,className:"specInput",type:"number"}),integer:u.a.createElement("input",{placeholder:"integer",id:e,className:"specInput",type:"number"}),boolean:u.a.createElement("input",{placeholder:"boolean",id:e,className:"specInput",type:"checkbox"})}[t]}(t,P.a.PropertySpec[e.state.type][t]);s.push(u.a.createElement("div",{key:t},u.a.createElement("div",null,t),a))})),t.push(s),t.push(u.a.createElement("button",{key:"create",onClick:this.onClick.bind(this)},"create")),t.push(u.a.createElement("button",{key:"effect_creator_cancel",onClick:function(){e.setState({progress:"plus"})}}," cancel "))}else console.warn("something bad has happened"),t.push(u.a.createElement("button",{onClick:function(){e.setState({progress:"type"})}}," + "));return u.a.createElement("div",{ref:this.ref,className:"EffectCreator"},u.a.createElement("div",null,u.a.createElement("div",null,"New Effect")),t)}},{key:"onClick",value:function(){var e=this,t={};Object.keys(P.a.PropertySpec[this.state.type]).forEach((function(a){var n=function(e,t){switch(t){case"array":return JSON.parse(e);case"string":return e;case"float":return parseFloat(e);case"integer":return parseInt(e);case"boolean":return"true"===e;default:return console.warn("Type not defined: "+t),e}}(e.ref.current.querySelector("#"+a).value,P.a.PropertySpec[e.state.type][a]);t[a]=n})),this.props.onCreate?this.props.onCreate(this.state.type,t):console.warn("onCreate not defineed for effect creator"),this.setState({progress:"plus"})}}]),t}(p.Component),ce=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(c.a)(t).call(this,e))).state={},a}return Object(l.a)(t,e),Object(s.a)(t,[{key:"changeTempo",value:function(e,t){var a=this.props;a.properties.tempo=t.properties.value,this.props.globalActions.masterUpdate(y.a.Languages.TidalCycles,a)}},{key:"getLanguageSpecific",value:function(){var e=this;switch(this.props.language){case y.a.Languages.TidalCycles:var t={language:"TidalCycles",on:!0,properties:{code:"Tempo",max:300,min:0,operator:"",scale:"linear",step:.01,value:this.props.properties.tempo},globalActions:{effectUpdate:this.changeTempo.bind(this)},noToggle:!0,key:"tempo",type:"SLIDER",updateEffect:this.changeTempo.bind(this)};return[u.a.createElement(se,{key:"tidalEditorMain",onChange:function(t){e.props.globalActions.masterUpdate(e.props.language,{macros:t})},onChangeLive:function(t){e.setState({bootScriptLive:t})},code:this.props.macros,live:!1}),u.a.createElement(ee,t)];case y.a.Languages.Hydra:return[u.a.createElement(se,{key:"HydraEditorMain",onChange:function(t){e.props.globalActions.masterUpdate(e.props.language,{macros:t})},onChangeLive:function(t){e.setState({bootScriptLive:t})},code:this.props.macros,live:!1})];default:return console.warn("unrecognized language: "+this.props.language),null}}},{key:"newEffect",value:function(e,t){this.props.globalActions.masterAddEffect(e,this.props.language,!1,t)}},{key:"updateEffect",value:function(e){this.props.globalActions.updateMasterEffect(e)}},{key:"effectIdToComponent",value:function(e){return u.a.createElement(te,{key:e,id:e,updateEffect:this.updateEffect.bind(this)})}},{key:"render",value:function(){var e=this.props.effects.map(this.effectIdToComponent.bind(this)),t=this.getLanguageSpecific();return u.a.createElement("div",{className:"LanguageControls"},t,e,u.a.createElement(ie,{onCreate:this.newEffect.bind(this)}))}}]),t}(p.Component),le=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(c.a)(t).call(this,e))).state={language:Object.keys(a.props.master)[0]},a}return Object(l.a)(t,e),Object(s.a)(t,[{key:"languageChange",value:function(e){this.setState(Object.assign({},this.state,{language:e.target.value}))}},{key:"render",value:function(){var e=Object.keys(this.props.master).map((function(e){return u.a.createElement("option",{key:e,value:e},e)}));return u.a.createElement("div",{className:"MasterEditor",style:this.props.style},u.a.createElement("select",{onChange:this.languageChange.bind(this),value:this.state.language},e),u.a.createElement(ce,Object.assign({},this.props.master[this.state.language],{language:this.state.language,globalActions:this.props.globalActions})))}},{key:"toggle",value:function(e){this.props.globalActions.toggleLive(e.target.checked)}}]),t}(p.Component),pe=(a(128),a(196)),ue=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(c.a)(t).call(this,e))).state={code:a.props.code},a.updateCode=Q()(a._updateCode,1e3),a.textAreaRef=u.a.createRef(),a}return Object(l.a)(t,e),Object(s.a)(t,[{key:"effectIdToComponent",value:function(e){return u.a.createElement(te,{key:e,id:e})}},{key:"render",value:function(){var e=this,t=this.props.effects.map(this.effectIdToComponent.bind(this));return u.a.createElement("div",{className:"StemEditor",style:this.props.style},"Name:",u.a.createElement("input",{style:{backgroundColor:"var(--stem-off)"},onChange:this.updateName.bind(this),type:"text",value:this.props.name}),u.a.createElement("select",{value:this.props.language,onChange:this.handleLanguageChange.bind(this),name:"language"},Object.keys(y.a.Languages).map((function(e){return u.a.createElement("option",{key:e,value:e},e)}))),u.a.createElement(se,{onChange:function(t){return e.props.globalActions.stemUpdate(e.props.id,{code:t})},onChangeLive:function(t){return e.props.globalActions.stemUpdate(e.props.id,{live:t})},code:this.props.code,live:this.props.live}),u.a.createElement("div",null,t,u.a.createElement(ie,{onCreate:this.createEffect.bind(this)})),u.a.createElement(pe.a,{style:{marginTop:"5px"},onClick:this.delete.bind(this),color:"primary",variant:"outlined"},"delete"))}},{key:"createEffect",value:function(e,t){this.props.globalActions.stemAddEffect(this.props.id,e,this.props.language,!1,t)}},{key:"handleLanguageChange",value:function(e){this.props.globalActions.stemUpdateLanguage(this.props.id,e.target.value)}},{key:"maybeEval",value:function(e){var t=this;e.shiftKey&&"Enter"===e.key&&(e.preventDefault(),this.props.globalActions.stemUpdate(this.props.id,{code:this.state.code}),this.textAreaRef.current.classList.add("flash"),setTimeout((function(){t.textAreaRef.current.classList.remove("flash")}),250))}},{key:"delete",value:function(){this.props.globalActions.trackDeleteStem(this.props.trackId,this.props.id)}},{key:"updateEffect",value:function(e){var t=this.props.effects.map((function(t){return t.id===e.id?Object.assign(t,e,{}):t}));this.props.globalActions.stemUpdate(this.props.id,{effects:t})}},{key:"updateName",value:function(e){this.props.globalActions.stemUpdate(this.props.id,{name:e.target.value})}},{key:"_updateCode",value:function(e){this.props.globalActions.stemUpdate(this.props.id,{code:e.target.value})}}]),t}(p.Component),de=function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return u.a.createElement("div",{onClick:this.props.switchToTab,className:"Tab"+(this.props.selected?"":" unselected")},u.a.createElement("label",null,this.props.label),this.props.closeAble?u.a.createElement("svg",{onClick:this.props.closeTab,xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 18 18"},u.a.createElement("path",{d:"M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"})):null,this.props.selected?u.a.createElement("div",{className:"indicator"}):null)}}]),t}(p.Component),fe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(c.a)(t).call(this,e))).state={tab:"master",history:[]},a}return Object(l.a)(t,e),Object(s.a)(t,[{key:"switchTab",value:function(e){var t=this.props.stems.map((function(e){return e.id}));if("master"===e||t.includes(e)){var a=this.state.history.concat([e]);this.setState({tab:e,history:a})}else console.log("err tab not found")}},{key:"closeTab",value:function(e){var t,a,n=this;this.state.history.length-1?(a=(a=this.state.history.slice(0,-1)).filter((function(t){return t!==e})),t=a[a.length-1]||"master"):(t="master",a=this.state.history),this.setState({tab:t,history:a}),setTimeout((function(){n.props.globalActions.stemUpdate(e,{open:!1}),n.setState({tab:t,history:a})}),1)}},{key:"render",value:function(){var e=this,t=this.props.stems.map((function(t){return{tab:u.a.createElement(de,{switchToTab:function(){e.switchTab.bind(e)(t.id)},label:""===t.name?"<untitled>":t.name,key:t.id+"_tab",id:t.id,selected:e.state.tab===t.id,closeAble:!0,closeTab:function(){e.closeTab.bind(e)(t.id)}}),content:u.a.createElement(ue,Object.assign({style:{display:e.state.tab===t.id?"block":"none"},key:t.id+"_editor"},t,{globalActions:e.props.globalActions}))}}));return u.a.createElement("div",{className:"Flyout",style:this.props.style},u.a.createElement("div",{className:"scrollbarHidden"},u.a.createElement("div",{className:"TabContainer"},u.a.createElement(de,{switchToTab:function(){e.switchTab.bind(e)("master")},value:"master",label:"master",selected:"master"===this.state.tab}),t.map((function(e){return e.tab})))),u.a.createElement("div",{className:"content"},u.a.createElement(le,Object.assign({},this.props,{value:"master",style:{display:"master"===this.state.tab?"block":"none"}})),t.map((function(e){return e.content}))))}}]),t}(p.Component),he=Object(r.b)((function(e){var t=Object.keys(e.stems).map((function(t){return Object.assign({},e.stems[t],{id:t})})).filter((function(e){return e.open}));return{master:e.master,connection:e.connection,stems:t}}),(function(e){return{globalActions:F(e)}}))(fe),me=(a(129),a(130),a(78)),_e=a.n(me),ve=a(79),Ee=a.n(ve),ge=a(81),be=a.n(ge),ye=a(80),Ce=a.n(ye),Oe=a(83),Te=a.n(Oe),ke=a(82),je=a.n(ke),Se=(a(131),a(77)),De=a.n(Se),Ae=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(c.a)(t).call(this,e))).ref=u.a.createRef(),a}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.ref.current&&this.ref.current.focus()}},{key:"render",value:function(){return u.a.createElement("div",{ref:this.ref,className:"Modal",onKeyUp:this.onKeyPress.bind(this),tabIndex:2},u.a.createElement("div",{className:"modalBody"},u.a.createElement("div",{className:"modalClose"},u.a.createElement(De.a,{onClick:this.props.onClose})),u.a.createElement("div",{className:"modalContent"},this.props.children)))}},{key:"onKeyPress",value:function(e){"escape"===e.key.toLowerCase()&&this.props.onClose()}}]),t}(p.Component),we=a(84),Me=a.n(we),Ie=a(195),Re=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(c.a)(t).call(this,e))).state={connection:Object(d.a)({},a.props)},a.connect=Q()((function(){a.props.globalActions.connect(a.state.connection.url,a.state.connection.port)}),2e3),a}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return u.a.createElement("div",{className:"ConnectionSettings"},u.a.createElement("div",null,u.a.createElement(Ie.a,{style:{width:"50%",marginLeft:"5px"},label:"URL",value:this.state.connection.url,onChange:function(t){var a=e.state.connection;a.url=t.target.value,e.setState({connection:a}),e.connect()},margin:"normal"}),u.a.createElement(Ie.a,{style:{width:"50%",marginLeft:"5px",maxWidth:"100px"},label:"Port",type:"number",value:this.state.connection.port,onChange:function(t){var a=e.state.connection;a.port=parseInt(t.target.value),e.setState({connection:a}),e.connect()},margin:"normal"}),u.a.createElement("button",{style:{width:"100%"},onClick:this.connect},"reconnect"),u.a.createElement("button",{style:{width:"100%"},onClick:this.props.globalActions.pushState},"push state to other clients")))}}]),t}(p.Component),Le=Object(r.b)((function(e,t){return Object(d.a)({},e.connection,{},t)}),(function(e){return{globalActions:F(e)}}))(Re),Ue=(a(133),{"--bg-image":function(e){return u.a.createElement("input",{value:e.value,type:"text"})},"--launchspace-bg-color":function(e){return u.a.createElement("input",{value:e.value,type:"color"})},"--border-radius":function(e){return u.a.createElement("input",{value:e.value,type:"number"})},"--stem-on":function(e){return u.a.createElement("input",{value:e.value,type:"color"})},"--stem-off":function(e){return u.a.createElement("input",{value:e.value,type:"color"})},"--stem-editor-color":function(e){return u.a.createElement("input",{value:e.value,type:"color"})},"--font-family":function(e){return u.a.createElement("input",{value:e.value,type:"text"})},"--font-color-dark":function(e){return u.a.createElement("input",{value:e.value,type:"color"})},"--font-color-light":function(e){return u.a.createElement("input",{value:e.value,type:"color"})},"--scrollbar-width":function(e){return u.a.createElement("input",{value:e.value,type:"number"})},"--track-border-color":function(e){return u.a.createElement("input",{value:e.value,type:"color"})},"--select-color":function(e){return u.a.createElement("input",{value:e.value,type:"color"})},"--settings-background-color":function(e){return u.a.createElement("input",{value:e.value,type:"color"})},"--settings-font-color":function(e){return u.a.createElement("input",{value:e.value,type:"color"})},"--midi-background-color":function(e){return u.a.createElement("input",{value:e.value,type:"color"})}}),Pe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(c.a)(t).call(this,e))).state={connection:Object(d.a)({},a.props)},a.connect=Q()((function(){a.props.globalActions.connect(a.state.connection.url,a.state.connection.port)}),2e3),a}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=Object.keys(Ue).map((function(t){var a=Ue[t];return u.a.createElement("div",{key:t},t,u.a.createElement(a,{value:e.props[t]}))}));return u.a.createElement("div",{id:"Settings"},u.a.createElement("div",{className:"Setting"},u.a.createElement("h1",null,"Style"),u.a.createElement("form",null,t)))}}]),t}(p.Component),xe=Object(r.b)((function(e,t){return Object(d.a)({},e.settings,{},t)}),(function(e){return{globalActions:F(e)}}))(Pe),Ne={settings:u.a.createElement(xe,null),connections:u.a.createElement(Le,null),help:"Welcome to DeadCode! Should probably fill out these docs soon..."},Ke=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(c.a)(t).call(this,e))).state={modal:null},a}return Object(l.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.getModal(this.state.modal);return u.a.createElement("div",{className:"Header"},u.a.createElement(_e.a,{onClick:this.openSettings.bind(this)}),u.a.createElement(Ee.a,{onClick:this.props.globalActions.save}),u.a.createElement(Ce.a,{onClick:this.props.globalActions.load}),u.a.createElement(be.a,{onClick:this.props.globalActions.download}),u.a.createElement(je.a,{onClick:function(){e.props.globalActions.open()}}),u.a.createElement(Te.a,{onClick:this.openConnections.bind(this),style:{fill:this.props.connection.isConnected?"green":"red"}}),u.a.createElement(Me.a,{onClick:this.openHelp.bind(this)}),t)}},{key:"closeModal",value:function(){this.setState({modal:!1})}},{key:"getModal",value:function(e){var t=Ne[e];return t?u.a.createElement(Ae,{onClose:this.closeModal.bind(this)},t):null}},{key:"openSettings",value:function(){this.setState({modal:"settings"})}},{key:"openConnections",value:function(){this.setState({modal:"connections"})}},{key:"openHelp",value:function(){this.setState({modal:"help"})}}]),t}(p.Component),Fe=Object(r.b)((function(e,t){return Object(d.a)({connection:e.connection},t)}),(function(e){return{globalActions:F(e)}}))(Ke),He=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(i.a)(this,Object(c.a)(t).call(this,e))).state={divider:70,horizontalDivider:75},a.appRef=u.a.createRef(),a}return Object(l.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.props.globalActions.connect(window.location.hostname,this.props.connection.port)}},{key:"render",value:function(){return u.a.createElement("div",{onDragOver:function(e){e.preventDefault()},ref:this.appRef,className:"App",tabIndex:"0",onKeyDown:this.macros.bind(this)},u.a.createElement(Fe,null),u.a.createElement("div",{style:{height:"100%"}},u.a.createElement(oe,{style:{width:this.state.divider+"%"}}),u.a.createElement("div",{id:"rightPanel",style:{width:100-this.state.divider+"%"}},u.a.createElement(he,{style:{height:this.state.horizontalDivider+"%"}}),u.a.createElement("iframe",{style:{height:100-this.state.horizontalDivider+"%",border:"1pt solid var(--stem-on)",borderBottom:"none",borderRight:"none"},src:"/render"}))))}},{key:"dividerResize",value:function(e){this.setState({divider:100*e/document.body.clientWidth})}},{key:"dividerResizeRightPanel",value:function(e){this.setState({horizontalDivider:100*e/document.body.clientHeight})}},{key:"macros",value:function(e){e.ctrlKey&&("s"===e.key?(e.preventDefault(),this.props.globalActions.save()):"l"===e.key.toLowerCase()?(e.preventDefault(),e.shiftKey?this.props.globalActions.loadFromServer():this.props.globalActions.load()):"d"===e.key?(e.preventDefault(),this.props.globalActions.download()):"o"===e.key?(e.preventDefault(),this.props.globalActions.open()):"p"===e.key&&(e.preventDefault(),this.props.globalActions.pushState()))}}]),t}(p.Component),We=Object(r.b)((function(e){return e}),(function(e){return{globalActions:F(e)}}))(He),Be=a(85),ze=a.n(Be),Ve=a(90),Ge=a(36),qe=a(86),Je=Object(r.b)((function(e){return e}),(function(e){return{globalActions:F(e)}}))(qe.a);Object(I.addMiddleware)(ze.a),Object(n.render)(u.a.createElement(Ve.a,{basename:"/DeadCode"},u.a.createElement(r.a,{store:L},u.a.createElement(Ge.a,{path:"/",exact:!0,component:We}),u.a.createElement(Ge.a,{path:"/render",exact:!0,component:Je}))),document.getElementById("root"))},22:function(e,t,a){"use strict";var n=a(49),r={index:0,init:function(e){var t=Math.max.apply(Math,Object(n.a)(Object.keys(e.effects).map(parseFloat))),a=Math.max.apply(Math,Object(n.a)(Object.keys(e.tracks).map(parseFloat))),o=Math.max.apply(Math,Object(n.a)(Object.keys(e.stems).map(parseFloat)));r.index=Math.max(t,a,o)+1,console.log("loaded id index: "+r.index)},new:function(){return r.index+++""}};t.a=r},23:function(e,t,a){"use strict";var n=a(54);var r={getNew:function(e,t){return{macros:"",effects:[],properties:t}}},o=a(22),s=a(12),i=a(45),c={style:{"--bg-image":"radial-gradient(rgb(170,170,170), rgb(170,170,170));","--launchspace-bg-color":" transparent;","--border-radius":" 0px;","--stem-on":" rgb(0,255,240);","--stem-off":" rgba(230,230,230);","--stem-editor-color":" rgba(200, 200, 200, 0.5);","--font-family":"'Helventica', sans-serif;","--font-color-dark":" black;","--font-color-light":" rgb(30, 30, 30);","--scrollbar-width":" 0px;","--track-border-color":" lightgrey;","--select-color":" rgb(250,10,10);","--settings-background-color":"rgb(50,50,50);","--settings-font-color":"rgb(150,150,150);","--midi-background-color":"rgba(100,100,100,0.600);"}},l={top:0,left:0,rows:0,columns:0},p={Languages:{TidalCycles:"TidalCycles",Hydra:"Hydra"}},u={},d={},f={},h=r.getNew("TidalCycles",{tempo:120});for(var m in s.a.util.defaultEffects.TidalCycles()){var _=o.a.new();f[_]=s.a.util.defaultEffects.TidalCycles()[m],h.effects.push(_)}var v=r.getNew("Hydra",{mixMethod:"blend"});for(var E in s.a.util.defaultEffects.Hydra()){var g=o.a.new();f[g]=s.a.util.defaultEffects.Hydra()[E],v.effects.push(g)}for(var b={TidalCycles:h,Hydra:v},y=0;y<8;y++){var C=o.a.new();u[C]=n.a.getNew();for(var O=function(e){var t=o.a.new();d[t]=i.a.getNew(),s.a.util.defaultEffects.TidalCycles().forEach((function(e){var a=o.a.new();f[a]=e,d[t].effects.push(a)})),u[C].stems.push(t)},T=0;T<8;T++)O();var k=o.a.new();f[k]=s.a.getNew(s.a.Types.SLIDER,"TidalCycles",!0,{code:"gain",value:1,operator:"|*",min:0,max:2,step:.01,scale:"linear"}),u[C].effects.push(k)}p.defaultState={connection:{isConnected:!1,url:"",port:8001},master:b,copy:null,tracks:u,stems:d,effects:f,midi:l,settings:c};t.a=p},45:function(e,t,a){"use strict";var n=a(49),r=a(4),o=a(12);var s={getNew:function(){return{name:"",on:!1,selected:!1,open:!1,live:!1,language:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"TidalCycles",code:"",effects:[]}},clone:function(e){return Object(r.a)({},e,{effects:Object(n.a)(e.effects).map(o.a.clone)})}};t.a=s},51:function(e,t,a){"use strict";a(0);var n=a(12),r=a(23),o={language:"Hydra",getCode:function(e){e.master.Hydra.properties.mixMethod;var t,a=Object.keys(e.tracks).map((function(t){return function(e,t){var a,n=t.stems.map((function(t){return e.stems[t]})).filter((function(e){return e.on&&""!==e.code&&e.language===r.a.Languages.Hydra})).map((function(t){return function(e,t){var a=t.effects.map((function(t){return e.effects[t]})).filter((function(e){return e.on})).map(s);return t.code+a.join("")}(e,t)}));if(n.join(e.master.Hydra.properties.mixMethod+"("+1/n.length),!(n.length>0))return null;a=n[0];for(var o=1;o<n.length;o++)a+=".".concat(e.master.Hydra.properties.mixMethod,"(").concat(n[o],",").concat(1/n.length,")");var i=t.effects.map((function(t){return e.effects[t]})).filter((function(e){return e.on})).map(s);return a+i.join("")}(e,e.tracks[t])})).filter((function(e){return e}));a.length>0&&(t=a[0]);for(var n=1;n<a.length;n++)t+=".".concat(e.master.Hydra.properties.mixMethod,"(").concat(a[n],",").concat(1/a.length,")");var o=e.master.Hydra.effects.map((function(t){return e.effects[t]})).filter((function(e){return e.on})).map(s);t||(t="solid(0,0,0,0)");return t+o.join("")+".out()"},getMacros:function(e){return e.master.Hydra.macros}};function s(e){switch(e.type){case n.a.Types.CODE_TOGGLE:return e.properties.code;case n.a.Types.SLIDER:return"gain"===e.properties.code?".blend(solid(0,0,0,0),".concat(1-e.properties.value/2,")"):".".concat(e.properties.code,"(").concat(e.properties.value,")");default:console.warn("Hydra renderer not implemented for type "+e.type)}}({})[n.a.Types.SLIDER]=function(e){return".".concat(e.name,"(").concat(e.properties.value,")")};var i=a(59);a.d(t,"a",(function(){return c}));var c={Hydra:o,TidalCycles:i.b}},54:function(e,t,a){"use strict";var n=a(4),r=a(12),o=a(45);var s={getNew:function(){return{name:"New Track",stems:[],effects:[]}},clone:function(e){return Object(n.a)({},e,{stems:e.stems.map((function(e){return o.a.clone(e)})),effects:e.effects.map(r.a.clone)})}};t.a=s},59:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return c}));a(0);var n=a(23),r=a(12);var o={};function s(e){return o[e.type](e)}function i(e,t){var a=[];if(t.stems.forEach((function(t){var n=e.stems[t];n.on&&""!==n.code&&"TidalCycles"===n.language&&a.push(function(e,t){if(""===t.code)return null;var a=[];t.effects.forEach((function(t){var n=e.effects[t];n.on&&a.push(s(n))}));var n=a.join(" $ ");return n+=a.length?" $ ":"",n+=t.code}(e,n))})),a.length<1)return"";a=a.join(", ");var n=[];t.effects.forEach((function(t){var a=e.effects[t];a.on&&n.push(s(a))}));var r=n.join(" $ ");return"".concat(r," $ stack [").concat(a,"]")}o[r.a.Types.SLIDER]=function(e){return"(".concat(e.properties.operator," ").concat(e.properties.code," ").concat(e.properties.value,")")},o[r.a.Types.CODE_TOGGLE]=function(e){return"(".concat(e.properties.code,")")};var c={language:"TidalCycles",getCode:function(e){var t="stack [";t+=Object.keys(e.tracks).map((function(t){return i(e,e.tracks[t])})).filter((function(e){return""!==e})).join(", ")+"]";var a=[];e.master[n.a.Languages.TidalCycles].effects.forEach((function(t){var n=e.effects[t];n.on&&a.push(s(n))}));var r=a.join(" $ ");return"d1 $ ".concat(r).concat(a.length?" $ ":"").concat(t)},trackToCode:i,getTempoCode:function(e){return"setcps "+e.master.TidalCycles.properties.tempo/60/2}}},86:function(module,__webpack_exports__,__webpack_require__){"use strict";var _home_jamie_repos_DeadCode_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(6),_home_jamie_repos_DeadCode_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(7),_home_jamie_repos_DeadCode_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(9),_home_jamie_repos_DeadCode_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(8),_home_jamie_repos_DeadCode_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(10),react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(0),react__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_5__),_renderers__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(51),hydra_synth__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(87),hydra_synth__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(hydra_synth__WEBPACK_IMPORTED_MODULE_7__),_index_css__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(159),_index_css__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(_index_css__WEBPACK_IMPORTED_MODULE_8__),_renderers_TidalCycles_dom__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(89),Render=function(_Component){function Render(e){var t;return Object(_home_jamie_repos_DeadCode_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__.a)(this,Render),(t=Object(_home_jamie_repos_DeadCode_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__.a)(this,Object(_home_jamie_repos_DeadCode_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__.a)(Render).call(this,e))).hydraRef=react__WEBPACK_IMPORTED_MODULE_5___default.a.createRef(),t.hydraCode=_renderers__WEBPACK_IMPORTED_MODULE_6__.a.Hydra.getCode(t.props),t.hydraMacros=_renderers__WEBPACK_IMPORTED_MODULE_6__.a.Hydra.getMacros(t.props),t}return Object(_home_jamie_repos_DeadCode_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_4__.a)(Render,_Component),Object(_home_jamie_repos_DeadCode_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__.a)(Render,[{key:"componentDidMount",value:function(){this.props.globalActions.connect(window.location.hostname,this.props.connection.port);try{window.hydra=new hydra_synth__WEBPACK_IMPORTED_MODULE_7___default.a({canvas:this.hydraRef.current})}catch(e){console.warn("Unable to start hydra")}}},{key:"componentDidUpdate",value:function componentDidUpdate(prevProps,prevState,snapshot){var hydraCode=_renderers__WEBPACK_IMPORTED_MODULE_6__.a.Hydra.getCode(this.props),hydraMacros=_renderers__WEBPACK_IMPORTED_MODULE_6__.a.Hydra.getMacros(this.props);try{eval(hydraMacros)}catch(e){console.warn("Hydra Error",e)}if(this.hydraMacros=hydraMacros,hydraCode!==this.hydraCode){try{eval(hydraCode)}catch(e){console.warn("Hydra Error",e)}this.hydraCode=hydraCode}}},{key:"render",value:function(){return react__WEBPACK_IMPORTED_MODULE_5___default.a.createElement("div",{style:{backgroundColor:"black",width:"100%",height:"100%"}},react__WEBPACK_IMPORTED_MODULE_5___default.a.createElement("div",{className:"Render"},react__WEBPACK_IMPORTED_MODULE_5___default.a.createElement(_renderers_TidalCycles_dom__WEBPACK_IMPORTED_MODULE_9__.a,this.props)),react__WEBPACK_IMPORTED_MODULE_5___default.a.createElement("canvas",{id:"HydraCanvas",ref:this.hydraRef}))}}]),Render}(react__WEBPACK_IMPORTED_MODULE_5__.Component);__webpack_exports__.a=Render},89:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(6),r=a(7),o=a(9),s=a(8),i=a(10),c=a(0),l=a.n(c),p=a(59),u=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(o.a)(this,Object(s.a)(t).call(this,e))).ref=l.a.createRef(),a.state={fontSize:36,isCorrectSize:!0},a.justMinimized=!1,a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"componentDidUpdate",value:function(e,t,a){if((this.ref.current.scrollHeight-this.ref.current.clientHeight)/this.ref.current.clientHeight>0)this.justMinimized=!0,this.setState({fontSize:this.state.fontSize-1});else{var n=0;this.ref.current.childNodes.forEach((function(e){n+=e.clientHeight})),console.log(n/this.ref.current.clientHeight),n/this.ref.current.clientHeight<.95&&0!==n&&!this.justMinimized&&(this.justMinimized=!1,this.setState({fontSize:this.state.fontSize+1})),this.justMinimized=!1}}},{key:"render",value:function(){var e=this,t=Object.keys(this.props.tracks).map((function(t){return function(e,t,a){var n=[];if(t.stems.forEach((function(t){var a=e.stems[t];a.on&&""!==a.code&&"TidalCycles"===a.language&&n.push(function(e,t,a){if(""===t.code)return null;var n=[];return t.effects.forEach((function(t){var a=e.effects[t];a.on&&n.push(d(e,a,t))})),setTimeout((function(){document.getElementById(a).classList.remove("justAdded")}),0),l.a.createElement("span",{id:a,key:a,className:"stem justAdded"},n,"$",l.a.createElement("span",null,t.code))}(e,a,t))})),n.length<1)return null;var r=[];return t.effects.forEach((function(t){var a=e.effects[t];a.on&&r.push(d(e,a,t))})),l.a.createElement("div",{key:a,className:"track"},r,"$",n)}(e.props,e.props.tracks[t],t)}));return l.a.createElement("div",{style:{fontSize:this.state.fontSize},ref:this.ref,className:"code"},t)}}]),t}(c.Component);function d(e,t,a){var n=p.a[t.type](t)+" ";return l.a.createElement("span",{id:a,key:a,className:"effect"},"(|* gain 1) "===n?"":n)}},96:function(e,t,a){e.exports=a(161)}},[[96,1,2]]]);
//# sourceMappingURL=main.651b8f61.chunk.js.map